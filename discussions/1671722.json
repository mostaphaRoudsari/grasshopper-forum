{"body": "\nHi,\n\nI've been trying quite a while to make the attached to work but without success.\n\nIt started as a section that included part of a wall. Now i took out this part and left only the window.\n\nThe HB_writeTHERM complains about:\n\nGeometry connected to _polygons does not have a single boundary (there are holes in the model). \u00a0You will have to fill in these gaps when you bring your model into THERM.\n\nI can't see where these gaps can be. Tried the dupborder check, but nothing.\n\nOpening the created therm file in THERM gives me:\n\nThere are points in the model that are closer together than the program tolerance.\n\nBut also there i can see where is/are the faulty geometries.\n\n\n\nWill appreciate any help here to understand what i'm doing wrong.\n\nThanks,\n\n-A.\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1671721", "name": "ThermSection.gh"}], "created_by_name": "Abraham Yezioro", "created_at": "January 13, 2017 at 12:42pm", "created_by": "AbrahamYezioro", "topic": "THERM - Window section issues", "replies": [{"body": "\nHi Abraham,\n\nYou were on the right route to getting your issue solved. \u00a0When you join all of your polygon surfaces together and use the dupborder command, you should be checking to see the number of borders that get produced. \u00a0If it is more than 1, then you have a hole in your model. \u00a0Here is how I checked for the hole in you model:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/XXixQWRYlp4yGr6VXqgTtDrPxoGmxuc7VQN2NTKrclUmijkWEMJShIEIk5aTxiD3-0B-0lmyLTry*iEaP0Tk*AE*KiXiTa*G/Dup2Borders.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/XXixQWRYlp4yGr6VXqgTtDrPxoGmxuc7VQN2NTKrclUmijkWEMJShIEIk5aTxiD3-0B-0lmyLTry*iEaP0Tk*AE*KiXiTa*G/Dup2Borders.png)\n\nNote that the hole can be really small and I had to deselect the outer border with Cntrl+left click and use the \"zoom selected\" command to find your very tiny gap here:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/XXixQWRYlp5VNrV9f9PjFcfuRpPfkF5PwCAq8HCNfDEEM6HDsgBPgJd3QEER9TjqTVo18nksXZ8P*KxGfFKGDe5lbAn7Ci6w/OtherBorder.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/XXixQWRYlp5VNrV9f9PjFcfuRpPfkF5PwCAq8HCNfDEEM6HDsgBPgJd3QEER9TjqTVo18nksXZ8P*KxGfFKGDe5lbAn7Ci6w/OtherBorder.JPG)\n\nTo get rid of the gap, I deleted out the aluminum surface next to the hole, joined all of the polygons together, ran a dupborder command, and used the curve around the seleted aluminum surface to build a new surface with the PlanarSrf command (this ensures no gaps). \u00a0Then I brought all of the new aluminum geometry into GH, connected it up to the THERM components, and it ran the export component without and issue. \u00a0When you open the file in THERM, you will sometimes get the following message:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/XXixQWRYlp68Yb1fzGYnM3E2laENuYb8l*kGbEfTvqA*QczEmlVCWnuF1UTR3EhoqlJiXHqa37VQNkg0NJ-DxZAnQw28weCV/DontAdjustPoints.JPG\" width=\"303\"/>](http://api.ning.com:80/files/XXixQWRYlp68Yb1fzGYnM3E2laENuYb8l*kGbEfTvqA*QczEmlVCWnuF1UTR3EhoqlJiXHqa37VQNkg0NJ-DxZAnQw28weCV/DontAdjustPoints.JPG)\n\nIn this case, you should ignore it at take the default option (Mark the points but don't adjust them). \u00a0The reason why this error happens is just because there are no other CAD plugins for THERM and the software still freaks out whenever it recognizes that the geometry has not come from its own interface. After you simulate, you can bring your results back into Rhino/GH like so (and see attached):\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/XXixQWRYlp53t-JRtZD616kK*ulzNPSTMFXE*zj2yJv52*SrF7Py2FA8yALr2UoczkucIVd9jid3-O3JEvdjWnG78wxnqmoE/FinishedSimulation.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/XXixQWRYlp53t-JRtZD616kK*ulzNPSTMFXE*zj2yJv52*SrF7Py2FA8yALr2UoczkucIVd9jid3-O3JEvdjWnG78wxnqmoE/FinishedSimulation.JPG)\n\nI know that this seems like a lot of clean up work but trust me that this is far less than what it used to be when you had to build models from scratch in the THERM drawing interface.\n\n-Chris\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1671775", "name": "ThermSection_CWM.gh"}], "created_by_name": "Chris Mackey", "created_at": "January 13, 2017 at 6:33pm", "created_by": "ChrisMackey", "replies": [{"body": "\nThanks Chris!!!\n\nI was getting crazy with this. Specially since i built the polylines in Autocad and imported. Now i see that one of them had a \"double line\".\n\nMay i ask another one for the same case? From the HB_readTHERM i expected to get the uValues for the 4 boundary curves i defined in the input (I changed the input tags to List type, and now back to item, if you use the same fixed file). Instead i get only one of them (the frame). For some reason Therm don't get the other 3 boundary curves.\n\nThanks again,\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "January 14, 2017 at 1:52am", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nAbraham,\n\nYou had been assigning the U-Factor tags correctly and I have added in a message on the thermBC component that lets you know that this is happening. \u00a0The reason why all the tags were not showing up is that the glass polygon needs to have vertices that align with the endpoints of the therm BC line segments in order to be written into the thmx file. \u00a0You can see that I have done this in the attached file by generating the glass thermPolygon from a polyline that has vertices that align with the thermBC endpoints.\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Fxq0VavCSuBZ38ev1gqnQLF1UgtdBhY87mkiKHsGFh6qr0mNROq73KdWJZa5WcqpWp8vTCB7w6SX41ayrB-SYS0*O3TyOjmN/AllUFactorTags.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/Fxq0VavCSuBZ38ev1gqnQLF1UgtdBhY87mkiKHsGFh6qr0mNROq73KdWJZa5WcqpWp8vTCB7w6SX41ayrB-SYS0*O3TyOjmN/AllUFactorTags.JPG)\n\nI had been thinking of writing a check in the writeTHERM component to automatically split the polygons using the BCs when it sees that the BCs are not aligned with the polygons but it was increasing the calculation time a lot. \u00a0Perhaps I'll put this in but I'll make it optional.\n\n-Chris\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1672695", "name": "ThermSection_CWM2.gh"}], "created_by_name": "Chris Mackey", "created_at": "January 16, 2017 at 6:21am", "created_by": "ChrisMackey", "replies": []}, {"body": "\nAhhhhhhhh. That trick!! :-)\n\nThanks a lot. Now makes sense.\n\nWhatever you can do to ease the process will be blessed. Right now i'm using your definition, cause when i tried the insertion points is still not recognizing them. Sometimes i missed the exact location (not well aligned), but after fixing them (i think) ... no luck. For now i have to finish a presentation for class, but tomorrow i'll let my version a try.\n\n\n\nThanks again. This is awesome.\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "January 16, 2017 at 1:15pm", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nHi Chris,\n\nNow my own version works fine ... finally!!\n\nSomething happened now the messes the legend. I updated today the ThermBoundary component and right after that the legend is scrambled. See image. I assume that things are related.\n\n\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/llVO6PYtbd4g2Xrr6bM*0pXFF4zP6Vnmcgr0PVNiifwZI50a37Kv-sHUmqt6*t3j2lbPDvc*PRAs3aVzJPF5XJ*P0mRN5iA0/Capture.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/llVO6PYtbd4g2Xrr6bM*0pXFF4zP6Vnmcgr0PVNiifwZI50a37Kv-sHUmqt6*t3j2lbPDvc*PRAs3aVzJPF5XJ*P0mRN5iA0/Capture.JPG)Thanks,\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "January 17, 2017 at 9:37am", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nHi,\n\nSomehow the issue dissapeared and the legend shows now. Was weird. So disregard the previous comment.\n\nThanks again and this is great!!\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "January 18, 2017 at 4:13am", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nHi again,\n\nThe previous issue appeared again and now i can't make it dissapear (messed legend). I can't say what i did to make it happen, so i don't know where to point a finger. Just can say that it started when the ThermBoundary component was updated.\n\nAfter the previous paragraph, I copied from another file a previous version of the component and the legend was fixed. Switched back to the updated version and it is working now.\n\nWeird, but there is an issue here. FYI.\n\nThanks,\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "January 21, 2017 at 12:01pm", "created_by": "AbrahamYezioro", "replies": []}]}]}