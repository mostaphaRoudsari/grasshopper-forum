{"body": "\nDear \u00a0all,\n\nI am trying to find optimum tilt angle with ladybug by using TOF component.\n\nis it necessary\u00a0to know what is inside the TOF and which formulas are used for estimating total annual solar radiation as well as the\u00a0optimum tilt angle. But the problems\u00a0are the formula inside the TOF. EPW gives us 8760 hours data file that feeds into the diffuse and direct and ground-reflect solar radiation. but, it is not clear that we used all 8760 hours data or average the data for a whole year or....?\n\nand second questions is there is no any azimuth parameter inside the formulas. And how mesh is created without considering any azimuth parameter (see picture below).\u00a0\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/pBewlkvOZIi0VZBN1ryto3rNKN9mV0UlS6nha5ez8I8-QF8qJt95n-DMAtKhS3Vy01bwaPA6SfY0-wxQquUOjkH4f6*2Pe5h/5.png?width=750\" width=\"750\"/>](http://api.ning.com:80/files/pBewlkvOZIi0VZBN1ryto3rNKN9mV0UlS6nha5ez8I8-QF8qJt95n-DMAtKhS3Vy01bwaPA6SfY0-wxQquUOjkH4f6*2Pe5h/5.png)\u00a0\n\n\n", "attachments": [], "created_by_name": "Hamid", "created_at": "July 19, 2016 at 7:31am", "created_by": "Hamid549", "topic": "TOF algorithm", "replies": [{"body": "\nHi Hamid,\n\n... EPW gives us 8760 hours data file that feeds into the diffuse and direct and ground-reflect solar radiation.\n\n[EnergyPlus directNormalRadiation](http://bigladdersoftware.com/epx/docs/8-3/auxiliary-programs/energyplus-weather-file-epw-data-dictionary.html#field-direct-normal-radiation)\u00a0is the radiation received on a surface perpendicular to the sun rays.<br/>Ladybug Photovoltaics components supports fixed PV systems, not tracking ones.<br/>So to get the incident radiation on a fixed\u00a0_PV_SWHsurface we need to correct the .epw directNormalRadiation for the angle of incidence:<br/><br/>Ib = directNormalRadiation * cos(angleOfIncidence)<br/><br/>EnergyPlus does not contain the ground reflected component.<br/><br/>\n\n<br/>but, it is not clear that we used all 8760 hours data or average the data for a whole year or....?\n\nThe incident solar radiation is calculated for each hour during a year in kWh/m2. Then all those hourly values are summed, to get the annual incident solar radiation in kWh/m2 for the inputted _PV_SWHsurface.\n\n\n\nand second questions is there is no any azimuth parameter inside the formulas. And how mesh is created without considering any azimuth parameter (see picture below).\n\nI did not understand you.<br/>The azimuth is not present in which formulas? Can you make a screenshot and label them?<br/>Thank you.\n", "attachments": [], "created_by_name": "djordje", "created_at": "July 19, 2016 at 11:04am", "created_by": "djordje", "replies": [{"body": "\nThanks a lot Djordje\n\nfor the\u00a0first question: Diffuse solar radiation also needs to be corrected or no? if no what is the formula? and which formula is used for ground-reflected\u00a0component? and all these formulas are used inside TOF?\n\nfor the\u00a0second question: can you tell me which values changed\u00a0for the hourly incident solar radiation? I mean, for example for Ib,\u00a0directNormalRadiation comes from EPW and angle of incidence just change?\n\nthank you<br/>\n", "attachments": [], "created_by_name": "Hamid", "created_at": "July 19, 2016 at 11:25am", "created_by": "Hamid549", "replies": []}, {"body": "\nfor the third question, please look the x-axis\u00a0in the following picture is about azimuth angle. for each azimuth\u00a0angle (90-270) we have some points.The solar radiation differs depending on the tilt and orientation of a surface. the chart is based on the tilt angle and azimuth angle to obtain the maximum solar radiation as well as the\u00a0optimal tilt angle so we need the formulas that have tilt angle and azimuth angle to obtain the solar radiation component.\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/v6XxXFfEuuQOcpejDV*zW9PL8zXP-WL36JC*vSRbMDZwx95mNyf5YuczUkJSg3ItAehsgz09PE*1GvrUmpju9O3y6hy3w8la/5.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/v6XxXFfEuuQOcpejDV*zW9PL8zXP-WL36JC*vSRbMDZwx95mNyf5YuczUkJSg3ItAehsgz09PE*1GvrUmpju9O3y6hy3w8la/5.png)\n", "attachments": [], "created_by_name": "Hamid", "created_at": "July 19, 2016 at 12:04pm", "created_by": "Hamid549", "replies": []}, {"body": "\n<br/>Diffuse solar radiation also needs to be corrected or no? if no what is the formula?\n\nEpw's\u00a0[diffuseHorizontalRadiation](http://bigladdersoftware.com/epx/docs/8-3/auxiliary-programs/energyplus-weather-file-epw-data-dictionary.html#field-diffuse-horizontal-radiation) is measured on a horizontal surface.<br/>The Perez diffuse model (which Ladybug Photovoltaics are using) uses this data along with previously mentioned directNormalRadiation to calculate the diffuse radiation on angled _PV_SWH_surface. It calculates three components of the diffuse radiation. You can read more about it in the [SAM Photovoltaic reference](http://www.nrel.gov/docs/fy15osti/64102.pdf).\n\n\n\nand which formula is used for ground-reflected\u00a0component? and all these formulas are used inside TOF?\n\nI gave you a reply on this in the [Annual optimal tilt and azimuth angle of an unshaded PV array comments](http://www.grasshopper3d.com/xn/detail/2985220:Comment:1557172?xg_source=activity). And yes, all those formulas are used by the TOF component.\n\n<br/>for the second question: can you tell me which values changed for the hourly incident solar radiation? I mean, for example for Ib, directNormalRadiation comes from EPW and angle of incidence just change?\n\nYes.\n\ndirectNormalRadiation, diffuseHorizontalRadiation and dryBulbTemperature are taken from the .epw file. Everything else is calculated (angles, shading factors...).\n\n\n\nfor the third question, please look the x-axis in the following picture is about azimuth angle. for each azimuth angle we have some points. the chart is based on the tilt angle and azimuth angle to obtain the maximum solar radiation as well as the optimal tilt angle so we need the formulas that have tilt angle and azimuth angle to obtain the solar radiation component.\n\nYou can also find an answer to this question in the [Annual optimal tilt and azimuth angle of an unshaded PV array comment](http://www.grasshopper3d.com/xn/detail/2985220:Comment:1557172?xg_source=activity).\n", "attachments": [], "created_by_name": "djordje", "created_at": "July 19, 2016 at 1:10pm", "created_by": "djordje", "replies": []}, {"body": "\nHi Djordje,\n\nthanks a lot for helping,\n\nplease tell me how can I import the values of beam, diffuse and ground-reflection and total solar radiation that they calculated inside the TOF?\n\nThank you\n", "attachments": [], "created_by_name": "Hamid", "created_at": "July 21, 2016 at 6:06am", "created_by": "Hamid549", "replies": []}, {"body": "\nHi Hamid, The beam, diffuse and ground-reflection components are calculated inside the TOF component they are not aviable through its outputs. Where do you want to import these value to?\n", "attachments": [], "created_by_name": "djordje", "created_at": "July 21, 2016 at 6:17am", "created_by": "djordje", "replies": []}, {"body": "\nI want to draw a figure\u00a0related to the values of diffuse,beam, ground-reflected as well as total solar radiation.\n", "attachments": [], "created_by_name": "Hamid", "created_at": "July 21, 2016 at 6:25am", "created_by": "Hamid549", "replies": []}, {"body": "\nI mean, I need those values to draw a figure( X-axis\u00a0(Hour or month) and Y-axis (the values of solar radiation )) by grasshopper into Rhino or by excel. I need just the amounts.\n", "attachments": [], "created_by_name": "Hamid", "created_at": "July 21, 2016 at 6:29am", "created_by": "Hamid549", "replies": []}, {"body": "\nBear in mind that these are huge amounts of values.<br/><br/>Each vertex (the black crosses on the photo below) of the TOF geometry mesh represents an annual solar radiation analysis with 8760 values:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/ME*KSY5V8nuSsGHl0pmilksH8hdGnHqx253idNnZVXHtb77FlsBs72IUpK-xsD0cZy2kaVnmn632aiEyx9AaFTIeDiWBG5aW/TOF_mesh_vertices.jpg?width=250\" width=\"250\"/>](http://api.ning.com:80/files/ME*KSY5V8nuSsGHl0pmilksH8hdGnHqx253idNnZVXHtb77FlsBs72IUpK-xsD0cZy2kaVnmn632aiEyx9AaFTIeDiWBG5aW/TOF_mesh_vertices.jpg)\n\nThe number of mesh vertices is defined as (**precision_**+1)^2.<br/>So if you would like to have its beam, diffuse and ground-reflected components as well, that means 3 * 8760 values per single point.<br/><br/>Example: if you set your **precision_** input to 20, the number of values would be a couple of millions:\n\n(20+1)^2 * 8760 * 3 = 11 589 480 hourly values\n\nCheck the attached definition below. The outputs that you need are: \"Ebeam\", \"Ediffuse\", \"Eground\".<br/>They contain annual hourly values for each tilt and azimuth combination (that's what upper mesh vertices represent) in a data tree.\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1569626", "name": "TOF_Eb_Ediff_Eground.gh"}], "created_by_name": "djordje", "created_at": "July 21, 2016 at 10:29am", "created_by": "djordje", "replies": []}]}, {"body": "\nHi Djordje,\n\nthanks for everything,\n\nI need to draw a figure with azimuth = 180 and tilt angle between 0-90 degrees. because my project is fixed solar panel with azimuth at 180 degrees and various tilt angle between 0-90 degrees. Please see the picture below and tell me how can I separate the values for beam, diffuse, ground-reflection as well as total solar radiation for azimuth at 180 and tilt angle at 0-90 degrees.[<img class=\"align-full\" src=\"http://api.ning.com:80/files/gnh1ndzD4Nw*zeY-7vuMo78ocsq0*wpOxiYegSj7OnCeku-SnQfv6IsM66MllcjZXtv5R5N-zIqWi-217TGshiNxzBfwQpez/Untitled.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/gnh1ndzD4Nw*zeY-7vuMo78ocsq0*wpOxiYegSj7OnCeku-SnQfv6IsM66MllcjZXtv5R5N-zIqWi-217TGshiNxzBfwQpez/Untitled.png)\u00a0\n", "attachments": [], "created_by_name": "Hamid", "created_at": "July 22, 2016 at 2:03am", "created_by": "Hamid549", "replies": [{"body": "\nI attached below a definition which picks only 180 azimuth orientations in a data tree.<br/><br/>If you intend to work with Grasshopper, data trees are one of its important aspects.<br/>You can learn more about them in the [Grasshopper Primer](http://modelab.is/grasshopper-primer), section 1.5\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1569707", "name": "TOF_Eb_Ediff_Eground2.gh"}], "created_by_name": "djordje", "created_at": "July 22, 2016 at 2:51am", "created_by": "djordje", "replies": []}, {"body": "\nthank you Djordje,\n\nIf I want to draw for annual solar radiation for azimuth=180 degrees and tilt angle (0-90 degrees), first, I have to use addition component (to add beam, diffuse, ground), second, use bar chart component to create into Rhino?\n", "attachments": [], "created_by_name": "Hamid", "created_at": "July 22, 2016 at 11:52pm", "created_by": "Hamid549", "replies": []}]}]}