{"body": "\nDear All,\n\nI've got a weather file from the Meteorological Organization in an excel file format which is attached, here. I'm trying to convert it into .EPW file, any thoughts about a tool or descript to do it?\n\nThanks in advance and any help is highly appreciated.\n\nRegards,\n\nYalda\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1476961", "name": "ARDAL1.xls"}], "created_by_name": "Yalda Sourani", "created_at": "March 3, 2016 at 6:30pm", "created_by": "YaldaSourani", "topic": "Ladybug- weather file", "replies": [{"body": "\nHi Yalda\n\n\n\nI had a look at your .xls file, the weather data must be **hourly** data to generate an .EPW file. Thus **8760** values instead 365. I know it is not easy to find them.\n\nHowever, I'm working on a new component that let you modify an existent .EPW file as you want, also just few hours or days or months of it.\n\nThis is a preview of it.\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/YiH**gdlUoWNKQWqw0LaUVf1-LrZofg1dgx8qpOlSo1KPLrjUbSHMrEoRnS0RGz6iB1vYO3n9rq0MPexrGaZIQGgKMlE6j7l/Canvas_01.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/YiH**gdlUoWNKQWqw0LaUVf1-LrZofg1dgx8qpOlSo1KPLrjUbSHMrEoRnS0RGz6iB1vYO3n9rq0MPexrGaZIQGgKMlE6j7l/Canvas_01.png)\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/YiH**gdlUoXJrTPj-M4AmpOqMU3f-w8MGrfIRfZbe-JEjjOimNiqLkbZw6SdoMH3RAN0u86gjSnhh*dfRqxR3Ijl469vZyGu/drybulbtemperature.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/YiH**gdlUoXJrTPj-M4AmpOqMU3f-w8MGrfIRfZbe-JEjjOimNiqLkbZw6SdoMH3RAN0u86gjSnhh*dfRqxR3Ijl469vZyGu/drybulbtemperature.png)\n\nThis new potential component creates a copy of Epw file automatically starting from an existing EPW file.\u00a0\u00a0In this case I modified dry bulb temperature from June to September, I added 5 \u00b0C to the original values.\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/YiH**gdlUoWomwFtnzhaC*hINqAqBtYpMgeeO5OJJ1b9A2B*waWEBRZHKF1OTYnaAns8Tlw*7E7sQGKFNAqrQ0wUULUKt7N6/Canvas_02.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/YiH**gdlUoWomwFtnzhaC*hINqAqBtYpMgeeO5OJJ1b9A2B*waWEBRZHKF1OTYnaAns8Tlw*7E7sQGKFNAqrQ0wUULUKt7N6/Canvas_02.png)\n\n\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/YiH**gdlUoWUTLSSc71mV-*Wfh7VIFMmg7qL-P*88fV-I*mAfbN4A8n05lJuz9EkUYhOj0u8xWC5pyV7Fj9zlwNLLfz9fYiU/drybulbtemperature02.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/YiH**gdlUoWUTLSSc71mV-*Wfh7VIFMmg7qL-P*88fV-I*mAfbN4A8n05lJuz9EkUYhOj0u8xWC5pyV7Fj9zlwNLLfz9fYiU/drybulbtemperature02.png)\n\n\n\nor you can create your own values, for example here I plugged random values.\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/YiH**gdlUoWlnKdxY0FvVyEK*Y7*YPQDbb6ZnRsGqyrIWNY7AOvV0qAusi3P1fw*4sYPFqdeT85YrmLSx*gI6vzBsVBK-m7K/Canvas_03.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/YiH**gdlUoWlnKdxY0FvVyEK*Y7*YPQDbb6ZnRsGqyrIWNY7AOvV0qAusi3P1fw*4sYPFqdeT85YrmLSx*gI6vzBsVBK-m7K/Canvas_03.png)\n\nOr you can copy and paste your values from .xls column of a weather data into a panel component.\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/YiH**gdlUoV8K9TXQQF8wUnGlo8QC3A-h39z2E9cywIoHoQAuhWccRws3XN0pRubfCjho5YAsoer-mu3ricKionzzWm2MlqU/folder.png\" width=\"102\"/>](http://api.ning.com:80/files/YiH**gdlUoV8K9TXQQF8wUnGlo8QC3A-h39z2E9cywIoHoQAuhWccRws3XN0pRubfCjho5YAsoer-mu3ricKionzzWm2MlqU/folder.png)\n\nAll your modified files are stored into a folder that you want.\n\nI think should be useful a component like this. Anyway, I'll try to finish it as soon as possible.\n\n\n\nBest\u00a0\n\nAntonello\n\n\n", "attachments": [], "created_by_name": "Antonello Di Nunzio", "created_at": "March 4, 2016 at 2:37am", "created_by": "AntonelloDiNunzio", "replies": [{"body": "\nHi Antonello,\n\n\n\nLooks like some of the stuff that you're recently working on are very similar to what I have implemented in the new Ladybug library:\u00a0[https://github.com/ladybug-analysis-tools/ladybug-core/blob/master/...](https://github.com/ladybug-analysis-tools/ladybug-core/blob/master/tests/ladybug-test.py#L62-L67)\n\n\n\nOne the one hand, the new development will be behind the current plugins and it's great that you're adding these features that are really needed. One the other hand I'm worried that we are duplicating work. It might be a good idea to get you involved in the new development as soon as possible to avoid this issue however then it will take much longer for your development to be ready to use by everyone in Grasshopper... I'm just thinking loud here. Thanks for the great work.\n\n\n\nMostapha\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "March 4, 2016 at 8:48am", "created_by": "MostaphaSadeghipour", "replies": []}, {"body": "\nHi Mostapha\n\n<br/>I'm sorry, I didn't know your script about Epw files.<br/>I thought and made this component yesterday night. I had this idea because of a problem that I had years ago about Epw files, writing manually some values of ENVI-Met inside it.\n\n\n\nAnyway, I'm agree with you about the problem of too many components. if you want I can send you this component like it appears now, thus you can see if there are some good ideas to complete your code. My Python is still too young ;) And if you need too much time to complete your code you could write a temporary component.\n\n\n\nIt works very well, I was thinking to add some others functions to read automatically the type of variable, and warnings, too. And it can edit all variables of Epw file.\n\n\n\nThe principle was to create a waterfall of these components, one for each variable edited. As you can see from this image.\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/18H-groRyDSV9r0JfOVvQmmPjOql1iicKQp9yTntVCEzaNrX0jEGpIDCvkxPCqDDRBcjnHF2HzeyIwIorYUn9F1dkShYbD5W/WATERFALLMETHOD.png?width=600\" width=\"600\"/>](http://api.ning.com:80/files/18H-groRyDSV9r0JfOVvQmmPjOql1iicKQp9yTntVCEzaNrX0jEGpIDCvkxPCqDDRBcjnHF2HzeyIwIorYUn9F1dkShYbD5W/WATERFALLMETHOD.png)\n\nIn this way you can track the editing.\n\nLet's talk about other ideas about this issue by email, ok? Thanks!\n\n\n\nBest\n\nAntonello\n", "attachments": [], "created_by_name": "Antonello Di Nunzio", "created_at": "March 4, 2016 at 10:56am", "created_by": "AntonelloDiNunzio", "replies": []}, {"body": "\nHi Antonello,\n\nThank you for your reply.\n\nThe new component which you are working on it\u00a0seems amazing! I was wondering when it will be finished. Actually, I need the epw\u00a0weather file as the basic data to do analysing on my project.\n\nCheers,\n\nYalda\n", "attachments": [], "created_by_name": "Yalda Sourani", "created_at": "March 5, 2016 at 8:35pm", "created_by": "YaldaSourani", "replies": []}]}, {"body": "\nHi Yalda,\n\nAs Antonello mentioned unless you have the data for every hour of the year you won't be able to create an epw weather file.\n\nMostapha\u00a0\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "March 4, 2016 at 8:34am", "created_by": "MostaphaSadeghipour", "replies": [{"body": "\nYalda, Mostapha and Antonello,\n\n\n\nI just wanted to make you aware of a related project that I have been working on that also should be better coordinated with Mostapha's efforts and I think will help with Yalda's issue here.\n\n\n\nThe impetus for this related project is that there are thousands of weather file stations in the world that are producing publicly-available hourly data but\u00a0have either not been running long enough to generate EPW files, have a few hours where there are gaps in the data, or are not keeping detailed radiation records that are required to produce EPW files. \u00a0 A full map of these weather stations (and links to order/download their data) can be found on the National Climatic Data Center (NCDC) website here:\n\n[http://gis.ncdc.noaa.gov/map/viewer/#app=cdo&amp;cfg=cdo&amp;theme=...](http://gis.ncdc.noaa.gov/map/viewer/#app=cdo&amp;cfg=cdo&amp;theme=hourly&amp;layers=1&amp;node=gi)\n\n\n\nI have been working on a component that can take the hourly data downloaded from the map database above and produce an actual-year EPW file for any station on the map if you have a base EPW file for a nearby location. \u00a0The main reason why I need the base EPW file is that many of these stations are not recording detailed radiation data with a pyranometer but they are often keeping detailed records of sky conditions like cloud cover and visibility (especially if they are airport weather stations). \u00a0By finding the correlation between these sky conditions and radiation in the initial base EPW file, I have been hoping that I can a pretty decent estimate of radiation for the weather station that is only recording sky conditions. \u00a0So far, the results look really promising but I really should quantify the percent error of this method before distributing it widely. \u00a0I followed this method to create an actual-year weather file for Paris in the deadly 2003 European heat wave as you see here:\n\n[http://www.payette.com/post/2963956-perspective-international-clima...](http://www.payette.com/post/2963956-perspective-international-climate-summit)\n\n\n\nGiven the opportunity to test this for another case, Yalda, I have produced an actual-year EPW file of 2015 for what I think is your site (assuming that the ARDAL you are referring to is the Ardal in Iran and not the one in Norway or India).\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/WYFQ5Cc97gospQ1iUsBhpYYIsWFrXOR8EEDTTO*L3qqMBZbOMcrcui9L9TQC6sDLc1W5tjOV*1e7ndjRsVxJRjLgV4CD3OBw/NCDCConnection.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/WYFQ5Cc97gospQ1iUsBhpYYIsWFrXOR8EEDTTO*L3qqMBZbOMcrcui9L9TQC6sDLc1W5tjOV*1e7ndjRsVxJRjLgV4CD3OBw/NCDCConnection.JPG)\n\nFor some reason, the peak temperatures in the NCDC records of Ardal are coming much earlier in the day than the nearby\u00a0Esfahan. \u00a0I am positive that this is something reflected in the NCDC and the WMO's records.\n\nYou can find the EPW file attached along with the GH file that I used to generate it and the 2015 text file that I downloaded from the map database (Shahr Kord). \u00a0The\u00a0the base EPW file that I used is from the US DoE database (Esfahan).\n\n\n\nI am planning to release this component for connecting to the NCDC database with Dragonfly (the new insect that I have been working on to extend the capabilities of LB+HB). \u00a0If any of you test out this workflow or have any feedback, please send it to me or post here.\n\n\n\n-Chris\n", "attachments": [], "created_by_name": "Chris Mackey", "created_at": "March 5, 2016 at 2:23pm", "created_by": "ChrisMackey", "replies": []}, {"body": "\nHi Chris,\n\nThanks for your time spending with my question and also sharing the NCDC website.\u00a0\n\nThe component which you have been working on would be great! Just let us know when is it released?\n\n\n\nRegarding my case location, you got it right, Ardal County at Chaharmahal Bakhtyari Province is in Iran. The only base EPW file you can find is from Esfahan where has the common border with Chahrmahal.\n\nAlso, I've received the Total Solar Radiation(TSR) file as well, which is attached, here. Could this file helpful?\n\nMay you please let me know how I can access to the EPW file that you have produced for my site?\n\n\n\nCheers,\n\nYalda\n\n\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1478248", "name": "TSR- Ardal.xls"}], "created_by_name": "Yalda Sourani", "created_at": "March 5, 2016 at 9:35pm", "created_by": "YaldaSourani", "replies": []}, {"body": "\nYalda,\n\nSomehow, I must have forgotten to attach the EPW file 3 months ago. \u00a0You can find it attached this time. The components are released as a beta and you can download them from the Dragonfly github:\n\n[https://github.com/chriswmackey/Dragonfly](https://github.com/chriswmackey/Dragonfly)\n\nYou can also find them in the example file attached.\n\n-Chris\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1532008", "name": "NCDC_AMY_Creator4.gh"}, {"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1532009", "name": "IRN_Esfahan.408000_ITMYAMY.epw"}], "created_by_name": "Chris Mackey", "created_at": "May 17, 2016 at 7:14pm", "created_by": "ChrisMackey", "replies": []}, {"body": "\nHi Chris,\n\nThanks for the EPW file. The components also are amazing!\n\n\n\nCheers,\n\nYalda\n", "attachments": [], "created_by_name": "Yalda Sourani", "created_at": "May 18, 2016 at 12:05am", "created_by": "YaldaSourani", "replies": []}, {"body": "\nAlso here is the download from the NCDC page:\n\n[http://gis.ncdc.noaa.gov/map/viewer/#app=cdo&amp;cfg=cdo&amp;theme=...](http://gis.ncdc.noaa.gov/map/viewer/#app=cdo&amp;cfg=cdo&amp;theme=hourly&amp;layers=1&amp;node=gi)\n\n-Chris\n", "attachments": [], "created_by_name": "Chris Mackey", "created_at": "May 17, 2016 at 7:18pm", "created_by": "ChrisMackey", "replies": []}, {"body": "\nHi Mostapha,\n\nThank you for getting beck to me.\n\nMay you please let me know how to create an epw\u00a0weather file if I have hourly data?\n\n\n\nThanks in advance.\n\nRegards,\n\nYalda\n", "attachments": [], "created_by_name": "Yalda Sourani", "created_at": "March 5, 2016 at 8:40pm", "created_by": "YaldaSourani", "replies": []}]}], "id": "1476962"}