{"body": "\nHello to everyone.\n\nI want to show you how I have modified the indoor airflow example to cover my need.\n\nThe experimental\u00a0case study is an office with an area of about 42 m<sup>2</sup>\u00a0normally occupied by four users. The air exchange system used consists of 2 fans: one introduces fresh air into the office, the other discharges the exhaust air. Both units have no filter or heat recovery system.\u00a0The average inlet/outlet air speed is equal to 2.0 m/s.\u00a0\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/3QCA0XbBBMyJbOKJ6vQtwIPf8CV8KntFimu0y0YZXBg-iHx9fqPaMFpMsVedQVkPSEavY1UVOmUbwyLZGWY1bZbid3-iDZts/Figure_2.jpg?width=750\" width=\"750\"/>](http://api.ning.com:80/files/3QCA0XbBBMyJbOKJ6vQtwIPf8CV8KntFimu0y0YZXBg-iHx9fqPaMFpMsVedQVkPSEavY1UVOmUbwyLZGWY1bZbid3-iDZts/Figure_2.jpg)\n\nThe model in Rhino is here below:\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/3QCA0XbBBMwoZZY76Dl*8tqpMWddY3crvof-N4ZdPxAl0cS7FC-MUOzpiJumXlHIyNyJfezoyTbapWVmSCzbbJ2hQAf9uakt/Cattura.JPG\" width=\"246\"/>](http://api.ning.com:80/files/3QCA0XbBBMwoZZY76Dl*8tqpMWddY3crvof-N4ZdPxAl0cS7FC-MUOzpiJumXlHIyNyJfezoyTbapWVmSCzbbJ2hQAf9uakt/Cattura.JPG)\n\nI have modified the Outlet boundary component considering a Velocity vector:\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/3QCA0XbBBMybZH-dfJTmgjSoavlmp-4E6mwS4z-7-yDAlSBAMbV1XqmtxHWJzuiCoKlY78axwRJZDG-HRUrySgmJOOOoDvq9/Cattura1.JPG?width=750\" width=\"750\"/>](http://api.ning.com:80/files/3QCA0XbBBMybZH-dfJTmgjSoavlmp-4E6mwS4z-7-yDAlSBAMbV1XqmtxHWJzuiCoKlY78axwRJZDG-HRUrySgmJOOOoDvq9/Cattura1.JPG)\n\nand changing the standard code of the outletBoundary component with that reported in the attached file.\n\nHere below the results:\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/3QCA0XbBBMznnfTHwIathk4GPQQSBvFb6yd1NqIHzSJ706JZlhsI*05jYH4pVJ3LTEeasf3dEvn2SnnjLsgPmg7dWLwlJeuG/Cattura3.JPG?width=750\" width=\"750\"/>](http://api.ning.com:80/files/3QCA0XbBBMznnfTHwIathk4GPQQSBvFb6yd1NqIHzSJ706JZlhsI*05jYH4pVJ3LTEeasf3dEvn2SnnjLsgPmg7dWLwlJeuG/Cattura3.JPG)\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/3QCA0XbBBMyFqocO0COp8iNsFvtAHLdcbQ0R*-aZ2B0r0I6*FcxCkcbnajOtd855PEnBHMnpLO*yunfPMK6Z00E2b3vRoTtn/Cattura4.JPG?width=750\" width=\"750\"/>](http://api.ning.com:80/files/3QCA0XbBBMyFqocO0COp8iNsFvtAHLdcbQ0R*-aZ2B0r0I6*FcxCkcbnajOtd855PEnBHMnpLO*yunfPMK6Z00E2b3vRoTtn/Cattura4.JPG)\n\n\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/3QCA0XbBBMy0KRE1Eo8XFE3h*cWgLsAp0c-SG*nl2CirkEWtQW04QUGW2n7GQ*9AcAF3SANbgoeeDoxn1vgt4mpPHG89Ib6H/Cattura5.JPG\" width=\"299\"/>](http://api.ning.com:80/files/3QCA0XbBBMy0KRE1Eo8XFE3h*cWgLsAp0c-SG*nl2CirkEWtQW04QUGW2n7GQ*9AcAF3SANbgoeeDoxn1vgt4mpPHG89Ib6H/Cattura5.JPG)\n\n\n\nThe pressure value [Pa] are the increment in relation to a base value (0 Pa = 0 atm) because I have not assigned a value of pressure in the outletBoundary Componet and the default value is 0, it's correct?\n\nComments and suggestion are welcome\n\n\n\nPS:\n\nmaybe in the samplefiles\u00a0folder of the downloaded Butterly zip there is an error:\u00a0a fixed value (273.15), that I think is related to the conversion of temperature from Kelvin to Celsius, is subtracted to the pressure values of the \"p\" field \u00a0\n\n\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/3QCA0XbBBMyy0z9WkWrsZutY95a0KZAnsNfPjV7SoMLCzD73-cHGWwl7w6xPrhvPyvI0HP3eSril7hBny7OiJtHqaYH*Q2C3/Cattura2.JPG?width=750\" width=\"750\"/>](http://api.ning.com:80/files/3QCA0XbBBMyy0z9WkWrsZutY95a0KZAnsNfPjV7SoMLCzD73-cHGWwl7w6xPrhvPyvI0HP3eSril7hBny7OiJtHqaYH*Q2C3/Cattura2.JPG)\n\n\n\n\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1643065", "name": "script_out_bound_butterfly_mod.txt"}], "created_by_name": "Francesco", "created_at": "November 21, 2016 at 4:03am", "created_by": "Francesco897", "topic": "Butterfly: outletBoundary component modification to model a case study", "replies": [{"body": "\nHi Fransesco!\n\n\n\nThanks for sharing the example with us! Great job! And thanks for catching our mistake in the example file, it will be rectified shortly! The pressure is calculated based on the reference condition I believe, which yes usually this is 0. Bare in mind that OF divides pressure by density, so if you want the 'real' pressure you would need to multiply the results by 1.205 (perhaps we add this in BF at some point but it's easy in native GH).\n\n\n\nVector based velocity is a very good idea, and a nice and easy way to model these kind of flows!\n\n\n\nIf you wish to experiment even further with the custom boundary condition components you can try implementing a flowRateInletVelocity boundary condition (see\u00a0[https://github.com/OpenFOAM/OpenFOAM-3.0.x/blob/master/src/finiteVo...](https://github.com/OpenFOAM/OpenFOAM-3.0.x/blob/master/src/finiteVolume/fields/fvPatchFields/derived/flowRateInletVelocity/flowRateInletVelocityFvPatchVectorField.H))\u00a0\n\n\n\nIt will allow you set the flows in m3/s, which is handy for usual HVAC specs. The direction of the patch follows the normal of the surface. Setting a minus in the volumetric flow rate assigns an opposite direction.\n\n\n\nThanks for using and sharing! Keep them coming!\n\n\n\nKind regards,\n\nTheodore.\n\n\n\nP.S.: Try this as an expirement. Increase the refinement of your mesh, factor of 4 should be nice. You can simply reduce the the blockMesh cell size by 4 to accomplish that. Try running the case and see the impact on the residual graph.\u00a0\n\n\n\n\n", "attachments": [], "created_by_name": "Theodoros Galanos", "created_at": "November 21, 2016 at 5:38am", "created_by": "TheodorosGalanos", "replies": [{"body": "\nP.S.: Try this as an expirement. Increase the refinement of your mesh, factor of 4 should be nice. You can simply reduce the the blockMesh cell size by 4 to accomplish that. Try running the case and see the impact on the residual graph.\u00a0\n\n1) how have you defined 4 as a \"nice\" factor?\n\n2) here below (sorry for the quality..) the residual graph with the blockMesh cell sized reduced by this factor:\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/3QCA0XbBBMwTLBGnYvNddmnuko8uulwSzoMr61eW8vxWG95ok49QSC9737W7HtEAhL9fYRivzaUuw-JEwK*74fkUwo5bvYbw/2.jpg?width=721\" width=\"721\"/>](http://api.ning.com:80/files/3QCA0XbBBMwTLBGnYvNddmnuko8uulwSzoMr61eW8vxWG95ok49QSC9737W7HtEAhL9fYRivzaUuw-JEwK*74fkUwo5bvYbw/2.jpg)\n", "attachments": [], "created_by_name": "Francesco", "created_at": "November 21, 2016 at 9:24am", "created_by": "Francesco897", "replies": []}, {"body": "\nHi Fransesco,\n\n\n\nI assumed you are working in meters and noticed that there were 2 cells per meter in your screenshots which is around 0.5m. For indoors, 0.1-0.2 is a good value so 4 times would get you there.\n\n\n\nThe pressure plot you shared above, it seems like your cell size varies, are you using any gradient options in the blockMesh step? In this example there'd be no need, as all areas are equally important.\u00a0\n\n\n\nIf I can see correctly (colors are missing :) ), the impact of mesh quality is already evident. If you compare the two residual plots, the first shows a case that is not converged and seems to be 'stuck in a bad place' where the residuals pulse around a min and max range without decreasing. The second shows the typical pattern of a converging case where residuals steadily decrease.\n\n\n\nKind regards,\n\nTheodore.\n\n\n\n\n\n\n\n\n", "attachments": [], "created_by_name": "Theodoros Galanos", "created_at": "November 21, 2016 at 3:23pm", "created_by": "TheodorosGalanos", "replies": []}, {"body": "\nHi Theodore,\n\n\n\nsorry for the delay\u00a0in responding.\n\n\n\n*I assumed you are working in meters and noticed that there were 2 cells per meter in your screenshots which is around 0.5m. For indoors, 0.1-0.2 is a good value so 4 times would get you there.*\n\n*Ok. I understood. You have to consider that the mesh displayed is generated by genTestPoints component where the grid size is effectively 0.5m:*\n\n*[<img class=\"align-center\" src=\"http://api.ning.com:80/files/I3qJw2-zaOEs*SahukV4MPzs9-16gFX-T-pdaPmVtKnqHkkzVUXbPATjmIO9gFMT0SsklVv8ysCZM6FdHJYZ4wsn4EvYZSwL/Cattura1.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/I3qJw2-zaOEs*SahukV4MPzs9-16gFX-T-pdaPmVtKnqHkkzVUXbPATjmIO9gFMT0SsklVv8ysCZM6FdHJYZ4wsn4EvYZSwL/Cattura1.JPG)*\n\n*The pressure plot you shared above, it seems like your cell size varies, are you using any gradient options in the blockMesh step? In this example there'd be no need, as all areas are equally important.<br/>*\n\n*The pressure plot varies because I have modified the cell grid size of the meshParams component in (0.25, 0.25, 0.25):*\n\n*[<img class=\"align-center\" src=\"http://api.ning.com:80/files/I3qJw2-zaOHUQHGsD8ow7nTGuZdxi2nkHmDglkK-PlxhgibBYJwEBFWz2uChmA-XqISKL5F8EXjFiP7r33tGkXC04wA3Kk2x/Cattura2.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/I3qJw2-zaOHUQHGsD8ow7nTGuZdxi2nkHmDglkK-PlxhgibBYJwEBFWz2uChmA-XqISKL5F8EXjFiP7r33tGkXC04wA3Kk2x/Cattura2.JPG)*\n\nNow, I have re-uploaded the basic values of (1,1,1) and modified the cell size in the blockmesh component as you suggested in the previous post:\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/I3qJw2-zaOHs3bQuLmPGRnjPVDFB*oORrOl8PIUCw48rnncK-cM4-XfkRsu*pvR5XjGk1twoGJ9AAFXrhKM69bm4vJPE4cB*/Cattura3.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/I3qJw2-zaOHs3bQuLmPGRnjPVDFB*oORrOl8PIUCw48rnncK-cM4-XfkRsu*pvR5XjGk1twoGJ9AAFXrhKM69bm4vJPE4cB*/Cattura3.JPG)\n\nAs cell size by default, this component considers the length/5. So, in this case, there would be a cell size of about (1.5, 1.1, 0.6). It\u2019s correct? But If I display the mesh with load mesh component connected to the case output of the snappyhexmesh component, I find this:\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/I3qJw2-zaOEkz74vHdTgVf1KWTwYYbI4M1qQo-HjsOa3meRNVXpAcBVOjCoJgnII635p*myHyV1slETYWf9SLk5WA61zKA8Z/mesh111.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/I3qJw2-zaOEkz74vHdTgVf1KWTwYYbI4M1qQo-HjsOa3meRNVXpAcBVOjCoJgnII635p*myHyV1slETYWf9SLk5WA61zKA8Z/mesh111.JPG)\n\nWith a cell size of (0.25, 0.25, 0.25) as modified in the screenshot of the blockmesh component reported above, the mesh is extremely dense:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/I3qJw2-zaOHOL*exq9P-EzFjJBQVDeLY2HUWiZX0SF6YagWN0RFIwW9Ch6nastuUzClC0GJM9v3EI3pIu76B0c6aYuRjXF6v/dense.JPG\" width=\"413\"/>](http://api.ning.com:80/files/I3qJw2-zaOHOL*exq9P-EzFjJBQVDeLY2HUWiZX0SF6YagWN0RFIwW9Ch6nastuUzClC0GJM9v3EI3pIu76B0c6aYuRjXF6v/dense.JPG)\n\nThe residuals decrease:\n\n[<img class=\"align-center\" src=\"http://api.ning.com:80/files/I3qJw2-zaOFHz5I9GuXD1hcXjhRXxZtamDuyc36Sg2JpnvyNP0y46H8Cb1wzcdBTsZDhV8E5jmdTOMR-29b7b5QSK2o*eRCq/residuals.jpg?width=721\" width=\"721\"/>](http://api.ning.com:80/files/I3qJw2-zaOFHz5I9GuXD1hcXjhRXxZtamDuyc36Sg2JpnvyNP0y46H8Cb1wzcdBTsZDhV8E5jmdTOMR-29b7b5QSK2o*eRCq/residuals.jpg)\n\nwith a more clear image.\n\n\n\nRegards,\n\nFrancesco\n", "attachments": [], "created_by_name": "Francesco", "created_at": "November 23, 2016 at 5:56am", "created_by": "Francesco897", "replies": []}]}], "id": "1643066"}