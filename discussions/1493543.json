{"body": "\nThis is a continuation of a previous post on the split building mass component:\n\n[http://www.grasshopper3d.com/group/ladybug/forum/topics/split-build...](http://www.grasshopper3d.com/group/ladybug/forum/topics/split-building-mass-component-works-for-only-a-few-masses?xg_source=activity)\n\n\n\nBasically, I want to create a workflow to automatically subdivide a building mass envelope geometry into different floors which will be further subdivided as perimeter zones and core zones.\n\n\n\nBut I encountered an error for a particular building mass geometry (a quite regular form) which doesn't work with the split building mass component (see item 4&amp;5 below):\n\n\n\nThe workflow is:\n\n1. import building mass geometry:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Y05Evaa5liHKZRDedOc8bYbGXJPmJbKImgeSbVpeYvz67LBXHbjQsg3bTRnRxyjXXRMgpwEF0WQ97Jtu4QBBew0xi2ezdX-7/Image3.png?width=750\" width=\"750\"/>](http://api.ning.com:80/files/Y05Evaa5liHKZRDedOc8bYbGXJPmJbKImgeSbVpeYvz67LBXHbjQsg3bTRnRxyjXXRMgpwEF0WQ97Jtu4QBBew0xi2ezdX-7/Image3.png)\n\n\n\n2. divide the building mass into floors (one zone per floor) using one of the two different methods depending on whether the floor surface has holes or not:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Y05Evaa5liFV1xdNQlh5lcSFl2N9yMo7h3UDSABR2lnZ9Ebhb82A8fm2Z2gjTVzDZuftfbkl*Lyuegz4MQEqfLDvOT76bWyr/Image5.png?width=750\" width=\"750\"/>](http://api.ning.com:80/files/Y05Evaa5liFV1xdNQlh5lcSFl2N9yMo7h3UDSABR2lnZ9Ebhb82A8fm2Z2gjTVzDZuftfbkl*Lyuegz4MQEqfLDvOT76bWyr/Image5.png)\n\n\n\n3. use the split building mass component to further divide the zone for each floor into perimeter zones and core zone:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Y05Evaa5liFQXmd92D4jKc20LScD*e65zIrnHWEjpPd4VTl8Lrz2huMJESsqqQZBWumJGSvz8RAXmCilr6eMs5tBNcbuUc3f/Image6.png?width=750\" width=\"750\"/>](http://api.ning.com:80/files/Y05Evaa5liFQXmd92D4jKc20LScD*e65zIrnHWEjpPd4VTl8Lrz2huMJESsqqQZBWumJGSvz8RAXmCilr6eMs5tBNcbuUc3f/Image6.png)\n\n\n\n4. I tested several building forms which work for this workflow as shown below, except for one form C05 which is a courtyard block with small tower blocks on top of it:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Y05Evaa5liHrSf868FrkTAH*WyprYP8UYObL9kgE9yjp7k8-fLifLwSWnYKMNC6LpxRK5HP3aBxLTCq141u0FCMYQUu09zwg/Image7.png?width=750\" width=\"750\"/>](http://api.ning.com:80/files/Y05Evaa5liHrSf868FrkTAH*WyprYP8UYObL9kgE9yjp7k8-fLifLwSWnYKMNC6LpxRK5HP3aBxLTCq141u0FCMYQUu09zwg/Image7.png)[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Y05Evaa5liE0M3WjCgq8lSubM61IfRvTDx1nyEUk9mI4qcw8KfmZ0eDPIjly2qkpW64Ga1oeH9X8RnqpyDisdHo-xS-YJgHi/Image8.png?width=750\" width=\"750\"/>](http://api.ning.com:80/files/Y05Evaa5liE0M3WjCgq8lSubM61IfRvTDx1nyEUk9mI4qcw8KfmZ0eDPIjly2qkpW64Ga1oeH9X8RnqpyDisdHo-xS-YJgHi/Image8.png)\n\n\n\n5. in the last step, there is an error from the split building mass component saying that \"solution exception: index out of range: 0\" ...\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Y05Evaa5liGcEQJKhKM8Wq6y1B3GO1b9LXJr6bJ2HDUcniwJ0v-9knJApZJiCVEwp42CAT6FDmx1mgyn*VoMPc0ZnGZUhDYn/Image9.png?width=750\" width=\"750\"/>](http://api.ning.com:80/files/Y05Evaa5liGcEQJKhKM8Wq6y1B3GO1b9LXJr6bJ2HDUcniwJ0v-9knJApZJiCVEwp42CAT6FDmx1mgyn*VoMPc0ZnGZUhDYn/Image9.png)[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Y05Evaa5liE2J49Dy2BC56aX1QKhGAdLeaZ2zAL*Wbnpt*ZIJM-i4YpPWiRNj6cUL9XvgiSCEuEaGP77NnbEhD7VIHO0sLAa/Image10.png?width=750\" width=\"750\"/>](http://api.ning.com:80/files/Y05Evaa5liE2J49Dy2BC56aX1QKhGAdLeaZ2zAL*Wbnpt*ZIJM-i4YpPWiRNj6cUL9XvgiSCEuEaGP77NnbEhD7VIHO0sLAa/Image10.png)\n\n\n\nSo, I wonder if this is error is related to the split building mass component or related to the way the building mass geometry is created.\n\n\n\nAppreciate your kind advice!\n\n\n\nThank you!\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1493542", "name": "zone_subdivision_error.gh"}], "created_by_name": "Grasshope", "created_at": "March 28, 2016 at 2:24am", "created_by": "Grasshope", "topic": "split building mass component error", "replies": [{"body": "\n... if I change the input method to \"Graft\" for the _bldgMasses input node on the split building mass component for this form C05, the calculation will stop at zone 31 with the following errors:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Y05Evaa5liHbpoAT2c16DvgEksXejD6hTEXft2ly06dK9NMek-bTCB90FUD29dvKqcoYlnjVXe5LQ1fLExnYfksPLQ0GoDW6/Image11.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/Y05Evaa5liHbpoAT2c16DvgEksXejD6hTEXft2ly06dK9NMek-bTCB90FUD29dvKqcoYlnjVXe5LQ1fLExnYfksPLQ0GoDW6/Image11.png)\n", "attachments": [], "created_by_name": "Grasshope", "created_at": "March 28, 2016 at 2:38am", "created_by": "Grasshope", "replies": []}, {"body": "\nHello Grasshope,\n\n\n\nI've noticed that the component will work if you change the height of the first contour point to a different value (0.5 in this case).\n\nI couldn't figure out what actually causes the error, but this might work as a temporary solution.\n\nM.\n\n\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/Y05Evaa5liHHgvbea2ntSZuK5NO8VM36Gw*p0N7YXC7tAJDTTTxzQh37-uNWwXqGE7VCGLt19CYdqbOMnUwT1lPysyiM9zvq/split_mass.png?width=645\" width=\"645\"/>](http://api.ning.com:80/files/Y05Evaa5liHHgvbea2ntSZuK5NO8VM36Gw*p0N7YXC7tAJDTTTxzQh37-uNWwXqGE7VCGLt19CYdqbOMnUwT1lPysyiM9zvq/split_mass.png)\n\n\n\n\n\n\n\n\n", "attachments": [], "created_by_name": "Michael Weizmann", "created_at": "March 28, 2016 at 3:28am", "created_by": "MichaelWeizmann", "replies": [{"body": "\nThank you very much, Michael, for find out this little peculiar condition...!\n\n\n\n... and I don't quite get why this parameter will make the workflow work, either...\n\n\n\n\n", "attachments": [], "created_by_name": "Grasshope", "created_at": "March 28, 2016 at 4:27am", "created_by": "Grasshope", "replies": []}, {"body": "\nHi Grasshope\n\n<br/>I tested your file. You used Honeybee_SplitBuildingMass nJAN_26_2016 in your workflow. If you try to use the latest version of it you'll see that the error message disappears, because there are two new lines inside the code that let you deal this issue.\u00a0However, the results for that type of geometry will be something like this:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/S49Nelh6z7Pyw88ipyw*yyWK**VOJOeyUyV1ag4mAOqnKTS-8lcOrXTdHZJCOknTwgb6o0nU4JTDFG-I3J-KZv7xff4pwEWI/ERROR_breps.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/S49Nelh6z7Pyw88ipyw*yyWK**VOJOeyUyV1ag4mAOqnKTS-8lcOrXTdHZJCOknTwgb6o0nU4JTDFG-I3J-KZv7xff4pwEWI/ERROR_breps.png)\n\nI think the issue is because of some curves in crvList.. and to solve it you have to play around the start number as Michael told you.\u00a0\n\nAnyway, If you want, you can try the attached file where there is a method which should be fine for both geometries in your file: with holes or not.\n\nThe principle is to set the first number of the series component to half of height of floor (e.g. floor = 3 meters \u00a0 =&gt; \u00a0 start = 1.5 meters) and you can create a piece of workflow to do this operation automatically.\n\n\n\nBest\n\nAntonello\n", "attachments": [], "created_by_name": "Antonello Di Nunzio", "created_at": "March 28, 2016 at 4:27pm", "created_by": "AntonelloDiNunzio", "replies": []}, {"body": "\nhere's the file\n\n\n\nBest\u00a0\n\nAntonello\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1494405", "name": "zone_subdivision_.gh"}], "created_by_name": "Antonello Di Nunzio", "created_at": "March 28, 2016 at 4:46pm", "created_by": "AntonelloDiNunzio", "replies": []}, {"body": "\nHello All,\n\n\n\nThank you for working through this issue together and I apologize for my messy code that tries to work around some of Rhino's deficiencies with solid operations.\n\n\n\nNow that I have understood how complex this operation of splitting building masses is, I think that the best way of addressing issues like this is to break up this component in two: one component to split masses into floors and another component to split floors into core/perimeter zones. \u00a0With this organization, it will be easier to build up a library of functions that can divide floors into core/perimeter, which is the main function that is failing here. \u00a0I have put this on the to-do list:\n\n[https://github.com/mostaphaRoudsari/Honeybee/issues/497](https://github.com/mostaphaRoudsari/Honeybee/issues/497)\n\nUntil I can get around to this or someone else takes on the challenge, you might have to play around with the component a bit (as yo have done Michael and Antonello) to get useful results.\n\n\n\nI apologize I can't be more help for the time being.\n\n-Chris\n", "attachments": [], "created_by_name": "Chris Mackey", "created_at": "March 28, 2016 at 8:37pm", "created_by": "ChrisMackey", "replies": []}, {"body": "\nDear Antonello and Chris, Thank you very much!\n\n\n\nI'll follow the suggestions here to use the component on a \"try on case-by-case basis\".\n\n\n\nAs to the workflow suggested by Antonello, I found that the \u201coffset distance of the cutting plane\u201d as the\u00a0quotient of the \"height of floor\" and the \"denominator value\" need to be carefully specified to avoid abnormal results in certain situations:\n\n\n\n1. Antonello's workflow should produce result like this up to the component \"boundary surfaces\":\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/xIFPN*W1TvK9RtWxHx1Qvm8xUoR0-0-ytWvEoc6T9kamjV1ywL0I1h7JM1Rz46wj2NRfLLbL2*1eESEl-1LRcTtyhsnyom3-/Image13.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/xIFPN*W1TvK9RtWxHx1Qvm8xUoR0-0-ytWvEoc6T9kamjV1ywL0I1h7JM1Rz46wj2NRfLLbL2*1eESEl-1LRcTtyhsnyom3-/Image13.png)\n\n2. but in the following situations the result is not correct:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/xIFPN*W1TvIWFooAmACmhmSGr2QLa5lmVmQIb4z5dJ0YpXd-LmH8-pmhFGdsA897nJR9OdXV11IildSUtQZgKcN4dym1dgGP/Image14.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/xIFPN*W1TvIWFooAmACmhmSGr2QLa5lmVmQIb4z5dJ0YpXd-LmH8-pmhFGdsA897nJR9OdXV11IildSUtQZgKcN4dym1dgGP/Image14.png)[<img class=\"align-full\" src=\"http://api.ning.com:80/files/xIFPN*W1TvIEisaUG5yK7AOss5Sl21DzNzxJCiab6jXpT4cDKGO2p4sNpwcyEEreoqPwdE*8BTlm4okJg*2vSnGv-K1Jv4nk/Image15.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/xIFPN*W1TvIEisaUG5yK7AOss5Sl21DzNzxJCiab6jXpT4cDKGO2p4sNpwcyEEreoqPwdE*8BTlm4okJg*2vSnGv-K1Jv4nk/Image15.png)[<img class=\"align-full\" src=\"http://api.ning.com:80/files/xIFPN*W1TvL5Et3sJrQjcKlb3AWNedO91w6wSlM8*IQaVC5SCQ4dZbzRrhnRsmCUdhpyPrdUc*uExSG3ZmWt6oqnUMi-X*2U/Image16.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/xIFPN*W1TvL5Et3sJrQjcKlb3AWNedO91w6wSlM8*IQaVC5SCQ4dZbzRrhnRsmCUdhpyPrdUc*uExSG3ZmWt6oqnUMi-X*2U/Image16.png)\n\n3. the source of issue might be that in these situations the cutting plane is overlapping with some of the horizontal surfaces of the geometry, creating boundary curves like B as shown below which will not generate correct floor surface for extrusion in later step:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/xIFPN*W1TvL7F0qFiLgY*WGiZnFMqm2JHqNFlTNQXlBQwB2RJR*0LAChxnDDY2Zv-rHwXrPnKAMPaIkWLx3d9AhSyLVNaiav/Image17.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/xIFPN*W1TvL7F0qFiLgY*WGiZnFMqm2JHqNFlTNQXlBQwB2RJR*0LAChxnDDY2Zv-rHwXrPnKAMPaIkWLx3d9AhSyLVNaiav/Image17.png)\n\nHope this helps in using Antonello's workflow.\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1494572", "name": "Antonello_split_floor_method_v002.gh"}], "created_by_name": "Grasshope", "created_at": "March 28, 2016 at 11:52pm", "created_by": "Grasshope", "replies": []}]}]}