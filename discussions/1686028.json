{"body": "\nHello,\n\n\n\nWe've been working with grid base simulation for a while and now we want to use radiance to generate 'quick' image of artificial lighting design but when using multiple CPUs the image seems to be divided and doesn't look good. While using 1 CPU achieves the objective the time is too slow.\n\n\n\nAny suggestions?\n\n\n\nThank you.\n\n\n\nJuan Carlos\n", "attachments": [], "created_by_name": "Juan Carlos Fornino", "created_at": "February 6, 2017 at 5:39am", "created_by": "JuanCarlosFornino", "topic": "Is it possible to run a HB image base simulation with multiple CPU for artificial lighting design?", "replies": [{"body": "\nImage-based analysis does run in parallel in Honeybee. Juan, can you share an example of what's happening in the results? Does it work fine without electric lights?\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "February 6, 2017 at 6:33am", "created_by": "MostaphaSadeghipour", "replies": [{"body": "\nThank you Omid and Mostapha.\n\n\n\nI am attaching a few pictures of how the results look using multiple CPUs.\n\n\n\nThe one without artificial lighting seems to no have the issues of breaking the image in multiple ones. The radiance setting are extremely low.\n\n\n\n\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1686039", "name": "artificial_lighting+dayligthing.TIF"}, {"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1686040", "name": "NO_artificial_lighting.TIF"}], "created_by_name": "Juan Carlos Fornino", "created_at": "February 6, 2017 at 7:29am", "created_by": "JuanCarlosFornino", "replies": []}, {"body": "\nOops,\n\nMany thanks Mostapha for catching that.\n", "attachments": [], "created_by_name": "Omid Rashidi", "created_at": "February 6, 2017 at 7:38am", "created_by": "OmidmRashidi", "replies": []}]}, {"body": "\nHi Juan,\n\n\n\nRadiance, the calculation engine employed by Honeybee to do lighting simulations, has different sets of\u00a0[optimization algorithms](http://radsite.lbl.gov/radiance/refer/long.html#Method) for calculating diffused and direct light. Keeping everything else in the model same, if only the lights are increased, any amount of additional direct lighting is likely to affect the accuracy of your rendering (and therefore deteriorate your rendering).\n\nBelow are two renderings with all the same parameters.\n\n[<img class=\"align-left\" src=\"http://api.ning.com:80/files/KIUhBV3mdZ87lr*TJ*dv4wm6ncOgWLagDbvd7RHzL5YSucghjePr21QxM8LKpB9Pw7EToeBCzGcDERVPHupD3uG2UU-SLJRC/262017112202PM.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/KIUhBV3mdZ87lr*TJ*dv4wm6ncOgWLagDbvd7RHzL5YSucghjePr21QxM8LKpB9Pw7EToeBCzGcDERVPHupD3uG2UU-SLJRC/262017112202PM.png)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[<img class=\"align-left\" src=\"http://api.ning.com:80/files/KIUhBV3mdZ91U5i4nYtmHQoPJ8sZF7ErtjtwjXIukII7udy6ISp6mx3qSXgaJdKbt4Q4ftT8g1isg7CeAy0LaXfYpCZhEMAd/262017111925PM.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/KIUhBV3mdZ91U5i4nYtmHQoPJ8sZF7ErtjtwjXIukII7udy6ISp6mx3qSXgaJdKbt4Q4ftT8g1isg7CeAy0LaXfYpCZhEMAd/262017111925PM.png)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a0\n\nNow, consider this case. The first image contains a model with daylight only.\n\n\n\n\n\n[<img class=\"align-left\" src=\"http://api.ning.com:80/files/KIUhBV3mdZ9fM3kg6CkMNfiKtExXZc4G5C7HbW-lwTgR9iIf8biyrCOK4gProa1ib7WaYn8Z0JoTDdnl87whAAJT7IfnXek7/day.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/KIUhBV3mdZ9fM3kg6CkMNfiKtExXZc4G5C7HbW-lwTgR9iIf8biyrCOK4gProa1ib7WaYn8Z0JoTDdnl87whAAJT7IfnXek7/day.png)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a0 The second image contains a model with daylight and electric light (inside the room).\n\n\n\n\n\n[<img class=\"align-left\" src=\"http://api.ning.com:80/files/KIUhBV3mdZ*aFLcRbKkiR6aVW2oMHxAX5W7N1dowrSy5hYHd9T1mYaC1bdMn90KK2aqlXjBJExzy*5d0eSh790YIdxwLXcac/elec.png?width=500\" width=\"500\"/>](http://api.ning.com:80/files/KIUhBV3mdZ*aFLcRbKkiR6aVW2oMHxAX5W7N1dowrSy5hYHd9T1mYaC1bdMn90KK2aqlXjBJExzy*5d0eSh790YIdxwLXcac/elec.png)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a0 As you'd notice in this case there is virtually no difference between the two images. This can be attributed to the fact that the electric lights do not really impact our perception of brightness in this rendering(as daylight is brighter).\n\n\n\nAs a rule of thumb, it is advisable to crank up the rendering settings in case you increase the light sources in your field of view. You can tweak the settings based on this\u00a0[look-up table](http://radsite.lbl.gov/radiance/refer/Notes/rpict_options.html) as well\n", "attachments": [], "created_by_name": "Sarith Subramaniam", "created_at": "February 6, 2017 at 10:12pm", "created_by": "sarith", "replies": [{"body": "\nThank you Sarith!\n\n\n\nWe did play with the radiance setting and we crank them up and the images look really good.\n\n\n\nAlso, we got specially good renders following the recommendations of -dt 0.03 and -dc 1 from[Radiance discussion](https://www.radiance-online.org:447/pipermail/radiance-general/2012-May/008610.html)\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1687143", "name": "Capture.PNG"}], "created_by_name": "Juan Carlos Fornino", "created_at": "February 7, 2017 at 3:28pm", "created_by": "JuanCarlosFornino", "replies": []}, {"body": "\nSarith and Mostapha,\n\n\n\nI have another question. What is the difference between the first rpict when it gives the number of rays, % and time.\u00a0\n\n[<img class=\"align-full\" height=\"267\" src=\"http://api.ning.com:80/files/C31AgRiB4u5MJOyDB38Rvn46-IxJgh68uUJQQi0s8qopWjE47kY4iDOlVuFWytl2Zh7i*McGUNus7bH5QT7p5Hf0ol734V4T/rpictexe2.PNG?width=721\" width=\"523\"/>](http://api.ning.com:80/files/C31AgRiB4u5MJOyDB38Rvn46-IxJgh68uUJQQi0s8qopWjE47kY4iDOlVuFWytl2Zh7i*McGUNus7bH5QT7p5Hf0ol734V4T/rpictexe2.PNG)\n\n\n\nWhen only 1 CPU is used and\u00a0\n\n[<img class=\"align-full\" height=\"305\" src=\"http://api.ning.com:80/files/C31AgRiB4u6tBPUa4Pf7-ZL5-GOauKd8l09ABDivINobZSXfszmEkqkzvWqvIe6zpiuEE2Opm4HQqFELrIsWh7cwLxwVQlhE/rpictexe3.PNG?width=721\" width=\"526\"/>](http://api.ning.com:80/files/C31AgRiB4u6tBPUa4Pf7-ZL5-GOauKd8l09ABDivINobZSXfszmEkqkzvWqvIe6zpiuEE2Opm4HQqFELrIsWh7cwLxwVQlhE/rpictexe3.PNG)\n\n\n\n\n\nThat second step that does use multiple CPU.\n\n\n\nIs there a way of optimising the first part or that can only be done with one CPU?\n\n\n\nThank you.\n\n\n", "attachments": [], "created_by_name": "Juan Carlos Fornino", "created_at": "February 8, 2017 at 5:16am", "created_by": "JuanCarlosFornino", "replies": []}, {"body": "\nHi Juan,\n\n\n\nThis relates to ambient calculations, and more specifically overture calculation. I had checked with Mostapha about this a few days back. Have a look at this\u00a0[presentation](https://www.radiance-online.org/community/workshops/2011-berkeley-ca/presentations/day1/JM_AmbientCalculation.pdf) from slide #62 onwards.\n\nThe multi-processor functionality that we see with Radiance in Honeybee is actually a clever hack that Mostapha had written. Image-based simulations in Radiance only run on single core in Windows machines. The idea of running a multiple core simulation relies on generating multiple images and then joining them together.\u00a0 These separate simulations are prone to errors due to sync issues on Windows.\n\nIt makes sense to do the overture calculations on the entire image (hence a single core) as the nature of ambient calculations is such that diffuse inter-reflections from different parts of the scene will affect each other. Once we save the ambient file from the overture calculation, the final simulation can be run on multiple cores (in which the case the simulation is split into n # of separate image-based simulations which are ultimately combined into a single image).\n\n\n\nSarith\n", "attachments": [], "created_by_name": "Sarith Subramaniam", "created_at": "February 8, 2017 at 6:04am", "created_by": "sarith", "replies": []}, {"body": "\nThanks Sarith, that helps understand a bit better.\n\n\n\nIs there a way to not run the overture calculation at all. Since what we want is to produce quick but good enough renders of multiple scenarios and that calculation seems to be the choking point.\n\n\n\nThanks.\n", "attachments": [], "created_by_name": "Juan Carlos Fornino", "created_at": "February 8, 2017 at 7:31am", "created_by": "JuanCarlosFornino", "replies": []}, {"body": "\nNot sure if that's a good idea but you can do it by passing runOverture=False to writeBatchFiles.\n\n\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/C31AgRiB4u4pWnk1T*p5mNN1ot5e5tvl1qgBVtHv0VvZVUeth5MuEBaACSWEOXnmzmCI39lhosrgDCwy79jPC3WygJgj7nrE/overture.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/C31AgRiB4u4pWnk1T*p5mNN1ot5e5tvl1qgBVtHv0VvZVUeth5MuEBaACSWEOXnmzmCI39lhosrgDCwy79jPC3WygJgj7nrE/overture.png)\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "February 8, 2017 at 7:45am", "created_by": "MostaphaSadeghipour", "replies": []}]}], "id": "1686028"}