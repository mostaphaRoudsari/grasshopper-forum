{"body": "\nHi,\n\n\n\nI added an Export to Openstudio component on my canvas. I got an error telling me to download the Csharp library from here: [https://app.box.com/s/y2sx16k98g1lfd3r47zi](https://app.box.com/s/y2sx16k98g1lfd3r47zi)\n\n\n\nFirst, if I may make a suggestion:\n\n1. I would add these steps to the [installation instructions](https://github.com/mostaphaRoudsari/ladybug/blob/master/resources/Installation_Instructions.txt)\n\n2. I would double quote the path, I got confused by whether I should include the \"_\" at the end of the path (%appdata%\\Ladybug\\OpenStudio_).\n\n\n\nAnyway, I downloaded the libraries, and pasted all the dll to the OpenStudio_ folder needed.\n\nBut it throws an exception on line 67:\n\nRuntime error (IOException): file does not exist: C:\\Users\\...\\AppData\\Roaming\\Ladybug\\OpenStudio_\\openStudio.dll<br/> Traceback:<br/> \u00a0 line 67, in script<br/>\n\nOne thing is that the box link for the libraries give you a zip that does include a dll that looks very similar... except it's cased differently: it is Upper Camel Case (OpenStudio.dll) and not Lower Camel Case (openStudio.dll)\n\n\n\nAnother thing is that even once I have renamed the above dll to match the casing, I still get this exception, even though os.path.isfile(os.path.join(openStudioLibFolder, \"openStudio.dll\")) returns True.\n\nIf I type the path on the run command it does land at the appropriate file...\n\n\n\nI'm confused, any ideas?\n\n\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/MoQW6swxykUD6HkvHWMuviLO8oNmXqr4Mb8WvMDsDov996QDA9IAqckojA3mgB5gOED8RluOjYY1y44gsLLBMimtWccug9PJ/2015032305_58_07OpenStudio_.jpg?width=750\" width=\"750\"/>](http://api.ning.com:80/files/MoQW6swxykUD6HkvHWMuviLO8oNmXqr4Mb8WvMDsDov996QDA9IAqckojA3mgB5gOED8RluOjYY1y44gsLLBMimtWccug9PJ/2015032305_58_07OpenStudio_.jpg)\n\n\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1248092", "name": "2015-03-23 05_58_07-OpenStudio_.jpg"}], "created_by_name": "Julien Marrec", "created_at": "March 23, 2015 at 4:01am", "created_by": "JulienMarrec", "topic": "Honeybee and Openstudio dll problem", "replies": [{"body": "\nHi Julien,\n\nCan you make sure to unblock .dll files? The easiest way is to unblock the .zip file before extracting it. Right Click and you will see the option.\n\nopenstudio_ is my bad. I changed the folder on my system inside the file that I sent to you and I forgot to change it back. Drag the openstudio component from Honeybee tab and that should look for openstudio folder.\n\n\n\nYes. I think we should have it as the last item in the list for installation instruction.\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "March 23, 2015 at 8:42am", "created_by": "MostaphaSadeghipour", "replies": [{"body": "\nAh! Thanks!\n\n\n\nFor others, the \"Unblock\" is in the right click menu, under Properties and under the general tab at the bottom\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/MoQW6swxykXUg2xG-aZWFCAoadJEuCm6yNqdsJ2N*bE1lrI-EzOcRnTYSWg59A1QCI5WliYslYm4n*CJrYSTXUqkaRsEzn-e/2015_03_23_11_06_19_openstudio_CSharp_64bits_Ver.1.4.0.zip_Properties.jpg\" width=\"488\"/>](http://api.ning.com:80/files/MoQW6swxykXUg2xG-aZWFCAoadJEuCm6yNqdsJ2N*bE1lrI-EzOcRnTYSWg59A1QCI5WliYslYm4n*CJrYSTXUqkaRsEzn-e/2015_03_23_11_06_19_openstudio_CSharp_64bits_Ver.1.4.0.zip_Properties.jpg)\n\nI put it back in \"%Appdata%\\Ladybug\\OpenStudio\" and it worked without changing the casing.\n\n\n\nBut I do get an error.\n\nRuntime error (TypeErrorException): prepareNonPlanarZone() got an unexpected keyword argument 'meshingLevel'\n\nTraceback:<br/>\u00a0 line 2451, in main, \"&lt;string&gt;\"<br/>\u00a0 line 2551, in script\n\n\n\nThoughts?\n", "attachments": [], "created_by_name": "Julien Marrec", "created_at": "March 23, 2015 at 9:14am", "created_by": "JulienMarrec", "replies": []}, {"body": "\nThat is a bug which I assume is fixed in the current version. Looks that you are using an older version of OpenStudio component. What is the date on the component?\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "March 23, 2015 at 10:58am", "created_by": "MostaphaSadeghipour", "replies": []}, {"body": "\nghenv.Component.Name = \"Honeybee_Export To OpenStudio\"<br/>ghenv.Component.NickName = 'exportToOpenStudio'<br/>ghenv.Component.Message = 'VER 0.0.56\\nFEB_01_2015'<br/>ghenv.Component.Category = \"Honeybee\"<br/>ghenv.Component.SubCategory = \"09 | Energy | Energy\"<br/>#compatibleHBVersion = VER 0.0.56\\nFEB_01_2015<br/>#compatibleLBVersion = VER 0.0.59\\nFEB_01_2015<br/>ghenv.Component.AdditionalHelpFromDocStrings = \"1\"\n", "attachments": [], "created_by_name": "Julien Marrec", "created_at": "March 23, 2015 at 11:53am", "created_by": "JulienMarrec", "replies": []}, {"body": "\nIs this version actually outdated then? I still can't make it work.\n", "attachments": [], "created_by_name": "Julien Marrec", "created_at": "March 24, 2015 at 7:43am", "created_by": "JulienMarrec", "replies": []}, {"body": "\nYes. There is a newer version for FEB_18_2015. I'm testing it now with nonplanar geometry to see if the issue is solved already.\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "March 24, 2015 at 8:43am", "created_by": "MostaphaSadeghipour", "replies": []}, {"body": "\nIt was a bug.\n\nFind this line:\n\nzone.prepareNonPlanarZone(meshingLevel = 1)\n\nand remove meshingLevel = 1\n\nzone.prepareNonPlanarZone()\n\n\n\nor just use the attached file. The attached file is using the most updated version of Ladybug and Honeybee. You can use update components to get the latest version or just download it manually from github.\n\n\n\nThank you for reporting this,\n\nMostapha\n\n\n\nPS: The new component should work for you but I think you should be able to model what you have all as planar surfaces.\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1249348", "name": "updatedOpenStudio.gh"}], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "March 24, 2015 at 8:57am", "created_by": "MostaphaSadeghipour", "replies": []}, {"body": "\nI updated the component, and I was still getting an error. Wouldn't be fun otherwise... :)\n\n\n\nThe error I was getting is:\n\n\n\nCurrent working directory is set to:\u00a0 C:\\Users\\...\\AppData\\Roaming\\Ladybug\\mall\\OpenStudio<br/>Analysis period is from 1 JAN to 31 DEC<br/>Between hours 1:00 to 24:00<br/><br/>the space type is:OS:SpaceType,<br/>\u00a0 {12884f42-3f62-4c4b-9d99-f321ff844e24}, !- Handle<br/>\u00a0 Retail:Entry;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 !- Name<br/><br/><br/>**[... 47 other \"space type is:OS:SpaceType ...]**<br/><br/><br/>the space type is:OS:SpaceType,<br/>\u00a0 {174829f0-0f70-40f5-b142-db610fc18b69}, !- Handle<br/>\u00a0 Retail:Retail;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 !- Name<br/><br/><br/>Runtime error (KeyNotFoundException): 3-Top-Bottom-Retail_Srf_1<br/>Traceback:<br/>\u00a0 line 1867, in setAdjacentSurfaces, \"&lt;string&gt;\"<br/>\u00a0 line 2680, in main, \"&lt;string&gt;\"<br/>\u00a0 line 2715, in script\n\n\n\nIt seems that it's processing some space without problems, but doesn't like this one one bit... After changing the name of the space, it worked.\n\n\n\nAnyway, I can now export to openstudio. But it won't load correctly in sketchup when I tried to open the exported .osm. Well, it does load, but it's only wireframes... I tried running the openstudio diagnostic on it, without success.\n\nHas anyone experienced that before?\n\n\n\nI've attached the gh file with internalized data if someone would be extremely kind to take a look at it... (please don't mention how bad the names I gave are... I'm aware :) ), as well as the exported .osm.\n\n\n\nThanks!\n\nJulien\n\n\n\nPS: don't be surprised if it takes some time to process... The solve adjacencies module takes about 2min to complete on my laptop)\n\n\n\nSide note: I've never managed to make the Grizzlybear work for gbXML export... but that can wait until I try it on a simple shoe box...\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1249457", "name": "2015-03-24_Mall.gh"}, {"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1249458", "name": "mall.osm"}], "created_by_name": "Julien Marrec", "created_at": "March 24, 2015 at 1:39pm", "created_by": "JulienMarrec", "replies": []}, {"body": "\nSalut Julien,\n\n\n\nI managed to open your osm file in OpenStudio and got it running the simulation. As the progress bar wasn't growing I stopped it and then checked the err file. I figured out that there are many floors and roofs upside down (you better check the normal on these surfaces), many non-planar surfaces and many errors about wrong solar distribution (you should use FullExterior with non-convex zones, as you have a couple of l-shaped rooms). Please see the file attached.\n\nI then opened your gh file and found a couple of brep missing (CenterWalkwayRoofRightSmall, the grazing surface of\u00a0RightWingWalkway-Roof) and many of your zones recognized as open breps (see the HB Create Zone outputs) because you missed some walls: check the input geometries.\n\nI hope I have been of help to you.\u00a0\n\n\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1250122", "name": "eplusout.err"}], "created_by_name": "Jacopo Sartore", "created_at": "March 25, 2015 at 9:00am", "created_by": "JacopoSartore", "replies": []}, {"body": "\nBuongiorno Jacopo,\n\n\n\nFor some reason I can't reply directly to your answer (must have reached the maximum reply limit), but yes this is helpful.\n\n\n\nI had already checked the err file and I knew I had problems, but mostly I was freaked out by the fact that it was always in wireframe. I fixed a couple of things, including two HBZones that carried the same name and manage to import it in OS. Then I painfully and slowly cleaned everything in OpenStudio since all my attempts at doing it in Rhino had failed.\n\n\n\nOne thing is that I redrew the geometry using the architectural Rhino model as guide... Turns out the architectural model wasn't very precise and a lot of stuff ended to be non planar.\n\nThese are Rhino questions and not a GH/HB one, but I'll ask them anyway.\n\nif I use \"Planar\" mode (command \"planar\" in Rhino), will that ensure my surfaces are planar or does object snapping take precedence?\n\nAlso, is there a way to force (transform/simplify) a closed brep with some non planar surfaces to only have planar surfaces? For example, I had a few boxes that had very minor offsets (&lt;1cm) but turned out non planar as a result...\n", "attachments": [], "created_by_name": "Julien Marrec", "created_at": "March 26, 2015 at 7:52am", "created_by": "JulienMarrec", "replies": []}, {"body": "\nif I use \"Planar\" mode (command \"planar\" in Rhino), will that ensure my surfaces are planar or does object snapping take precedence?\n\nAll your lines will be drawn in the active Cplane so it won't exactly do what are you looking for.\n\n\n\nis there a way to force (transform/simplify) a closed brep with some non planar surfaces to only have planar surfaces? For example, I had a few boxes that had very minor offsets (&lt;1cm) but turned out non planar as a result...<br/>\n\nYes. You can use Grasshopper to do that. There are more sophisticated solutions if you are willing to use plugins such as Kangaroo\u00a0but the simplest way is to\u00a0decompose the brep, get the plane for each face, project the original surfaces on that plane and join them back. The issue with this method is that it will more likely return an open Brep but there are solutions to address that too.\n\n\n\nHope it helps,\n\nMostapha\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "March 30, 2015 at 1:07pm", "created_by": "MostaphaSadeghipour", "replies": []}, {"body": "\nHi again, I felt bad after I sent the previous response as I probably left you there with a day of work as a person who is getting started with Grasshopper. :) Here is an example on how you can do it. It won't work for crazy geometries but it should work fine for simple ones.\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/3BUwwLuJMnTxbB0OXvi2mqW79lhrAhKPhYDrdnbQ3KyvABzDl5IFDaV7km0JtJMnkqgrSv7oMXUkI*u9g9A2RCchAsvdZH26/createClosedPlanarBreps.png?width=721\" width=\"721\"/>](http://api.ning.com:80/files/3BUwwLuJMnTxbB0OXvi2mqW79lhrAhKPhYDrdnbQ3KyvABzDl5IFDaV7km0JtJMnkqgrSv7oMXUkI*u9g9A2RCchAsvdZH26/createClosedPlanarBreps.png)\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1252920", "name": "createPlanarClosedGeometry.gh"}], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "March 30, 2015 at 1:20pm", "created_by": "MostaphaSadeghipour", "replies": []}]}]}