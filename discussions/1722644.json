{"body": "\nHi everyone,\n\n\n\nI am trying to add a new Predicted Mean Vote (from PIERCE foundation, FANGER and PICKUP and DE DEAR), thanks to Python_Script_Editor. But when I tried to visualize the matrix thanks to HoneyBee_Visualize_Microclimate_Map this error appeared \"**Solution exception:index out of range: 1\".**\n\n\n\nFrom my understanding, it seems that the HoneyBee_Visualize_Microclimate_Map component can\u2019t directly read a user-defined matrix (for example \"radTempMtx*2\") and requires that a list of variables be passed (hence the \u201cIronPython.Runtime.List\u201d as a output of the Microclimate_Map analysis).\n\n\u00a0\n\nAm I wrong ? And, in any case: is there a workaround to feed the HoneyBee_Visualize_Microclimate_Map component with a user defined matrix?\n\n\u00a0\n\nThank you very much for your time and answer\n\n\u00a0\n", "attachments": [], "created_by_name": "Mehdi HAMDANI", "created_at": "March 28, 2017 at 5:55am", "created_by": "MehdiHAMDANI", "topic": "User defined matrix for HoneyBee_Visualize_Microclimate_Map", "replies": [{"body": "\nMehdi,\n\nChris will answer this one much properly, but what i'll do is the following:[<img class=\"align-full\" src=\"http://api.ning.com:80/files/SfnwKUqQ7eCjHY66t6tSY8bZBBlJuGtC4mCzIz1w8xuG-aYXw0vkst2C484f29nSSt7i41Xz0FtajH1Opt7W1r-1hVV7J8zf/Capture.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/SfnwKUqQ7eCjHY66t6tSY8bZBBlJuGtC4mCzIz1w8xuG-aYXw0vkst2C484f29nSSt7i41Xz0FtajH1Opt7W1r-1hVV7J8zf/Capture.JPG)Basically you need to create a CSV file formated according to the output results of the MicroclimateMap. Then you can read it as a file and input them into the VisualizeMicroclimate.\n\nRun a case where you get such an output to see how the CSV is formated.\n\n-A.\n\n\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "March 28, 2017 at 7:21am", "created_by": "AbrahamYezioro", "replies": [{"body": "\nThank you Abraham,\n\n\n\nUnfortunately when I change the values of the csv files thanks to Excel and put the data like it was (, for between numbers) it didn't work. The error from the Honeybee_Visualize Microclimate Map is this time \"**Solution exception:index out of range: 0\"**. But with the origin csv it works fine.\n\n\n\nDo you know why there is this error ?\n\n\n\nI thought to create a new csv file thanks to Honeybee_Create CSV Schedule. But I have this error (the Python Script Editor multiplies the radTempMtx per 2) :\n\n\u00a0\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1722587", "name": "ghp.png"}], "created_by_name": "Mehdi HAMDANI", "created_at": "March 28, 2017 at 8:58am", "created_by": "MehdiHAMDANI", "replies": []}, {"body": "\nHard to say without the files. I believe it is more related to bad formatting than that it is not possible to do.\n\nJust from the image ... can guess many things.\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "March 28, 2017 at 9:04am", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nI found what it was it's just that the csv from excel add some spaces to the csv file.\n\n\n\nBut now another problem apeared, here the grasshopper file.\n\n\n\nThanks a lot\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1722669", "name": "Microclimate_Map_-_Simple.gh"}], "created_by_name": "Mehdi HAMDANI", "created_at": "March 28, 2017 at 9:29am", "created_by": "MehdiHAMDANI", "replies": []}, {"body": "\nYou have to output the list as a series of numbers and not by printing them out. The component needs 8760 values.\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "March 28, 2017 at 9:57am", "created_by": "MostaphaSadeghipour", "replies": []}, {"body": "\nHi Mostapha,\n\nThis is not the issue i believe.\n\nI just don't understand why Mehdi is trying to print/output to a csv file the matrix while it is already an output of the HB_MicroclimateMap component. All the 5 lower output items are producing csv files with the results. So why you don't used them instead of trying to get them from scratch.\n\nIn the specific case they are not 8760 values, but rather depending on the analysisPeriod simulated.\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "March 28, 2017 at 10:38am", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nHi Mostapha,<br/> <br/> I'll try to explain what I'm trying to do clearly (it's for a studying project for my school).<br/> <br/> The PMV defined in Honeybee is calculated from the steady state. My project is involving to calculate the comfort at the transient state (building with travellers), so I have coded a new PMV in Python and I want to visualize the comfort thanks to the Honeybee_Visualize_Microclimate_Map component.<br/> <br/> The problem here is when I create a new matrix by modifying radTempMtx the component can't read it (see above IronPython.Runtime.List). When Abraham showed me the component that transform a csv file into a Matrix, I thought to convert my modified Matrix (in the example radTempMtx*2) into a csv file and to convert this csv file into a matrix that the Honeybee component can read.<br/> <br/> Is it possible to do that and is there a better way to visualize the comfort without the csv method ?<br/> <br/> Thank you for your answers.\n", "attachments": [], "created_by_name": "Mehdi HAMDANI", "created_at": "March 29, 2017 at 8:40am", "created_by": "MehdiHAMDANI", "replies": []}]}, {"body": "\nMehdi,\n\nThis transient PMV is some interesting research! \u00a0First, I will note that the components in your file are from several different versions and this can cause errors. \u00a0The attached file has everything updated.\n\nNow to answer your question:\n\nThere are many ways to post-process the results of the microclimate maps. \u00a0I don't know how exactly you want to do this or of there is something particular about the CSV that you need but here's an example showing how you can grab the MRT, air temperature, and humidity outputs of an energy simulation and run the through the PMV Comfort Calculator component:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/rCeewRRND-ctZjfg5OACib2g-Gt6rdfXS*kMix61p1phQ4AtHv6iz-bQvKV0cocyUXHuOMAzohqC*BD41wlc0T4fxwZ63eHM/CutomPMVMap.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/rCeewRRND-ctZjfg5OACib2g-Gt6rdfXS*kMix61p1phQ4AtHv6iz-bQvKV0cocyUXHuOMAzohqC*BD41wlc0T4fxwZ63eHM/CutomPMVMap.JPG)\n\nI could not get your transient PMV component to run correctly on my machine but it's looking like you just want to take these microclimate map results and run them though your special PMV calculator. \u00a0Then, you can color the viewFactorMesh with the results like so:\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/rCeewRRND-fdLB2Le6qMdzGM3LjlXmPAwFITfVDLqelCviCj1dWHzxsTBc9onq0wBCVEBQaBA3g4ZvgEmN4HJZJU09ptQZm2/PMVVisual.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/rCeewRRND-fdLB2Le6qMdzGM3LjlXmPAwFITfVDLqelCviCj1dWHzxsTBc9onq0wBCVEBQaBA3g4ZvgEmN4HJZJU09ptQZm2/PMVVisual.JPG)\n\nLet use know if this answers your question.\n\n-Chris\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1723452", "name": "Microclimate_Map__Simple_CWM.gh"}], "created_by_name": "Chris Mackey", "created_at": "March 29, 2017 at 10:06am", "created_by": "ChrisMackey", "replies": [{"body": "\nThanks a lot Chris,\n\n\n\nI can now visualize my transient PMV on a map!\n\n\n", "attachments": [], "created_by_name": "Mehdi HAMDANI", "created_at": "March 30, 2017 at 6:13am", "created_by": "MehdiHAMDANI", "replies": []}]}], "id": "1722644"}