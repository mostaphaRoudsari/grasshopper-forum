{"body": "\nHi,\n\nI've been using Honeybee for a while with EnergyPlus, but this is the first time I'm trying to export a file to OpenStudio in order to create an HVAC system. I am using the latest release of HB&amp;LB (from last week). I've downloaded and installed OpenStudio 1.12.0 and made sure all the files are unblocked. Still, when I try to use the Export to OpenStudio component, I get the error\n\n\"Solution exception:The type initializer for 'OpenStudio.OpenStudioModelCorePINVOKE' threw an exception.\"\n\nwhich happens at the line\u00a0 \"model = ops.Model()\" in the script.\n\nI've tried uninstalling OpenStudio 1.12.0 and installing an older version (1.9.5) but get the same error.\n\n\n\nI've read through this thread ([https://github.com/mostaphaRoudsari/Honeybee/issues/214](https://github.com/mostaphaRoudsari/Honeybee/issues/214)) but am not sure how to fix it. Any ideas on what to try? Is there any way around this?\n\n\n\nJust fyi, I am using a 64-bit Windows 7 Enterprise desktop PC. Thanks in advance!\n", "attachments": [], "created_by_name": "Julia S", "created_at": "August 18, 2016 at 3:01pm", "created_by": "JuliaS", "topic": "Cannot Export to OpenStudio", "replies": [{"body": "\nHi Julia, This is really unfortunate. There is not that much that us (Honeybee developers) can do in this case as the issue is generated somewhere in OpenStudio libraries. There are a couple of tests that we can do but again there is nothing major that we can do. The newer version should work without problems. Did you try to close both Rhino and Grasshopper and re-open the file after you changed the version?\n", "attachments": [], "created_by_name": "Mostapha Sadeghipour Roudsari", "created_at": "August 18, 2016 at 5:30pm", "created_by": "MostaphaSadeghipour", "replies": [{"body": "\nJuila,\n\nThis is, indeed, very unfortunate. \u00a0We (Honeybee developers) have not experienced this bug for several versions of OpenStudio and we had hoped it was behind us.\n\nDo you have any earlier versions of OpenStudio installed? \u00a0Or openstudio dlls in your ladybug folder? If so, please uninstall/remove them.\n\nJust to be sure, can you upload your GH file so that we can be sure that the issue is specific to your system?\n\n-Chris\n", "attachments": [], "created_by_name": "Chris Mackey", "created_at": "August 18, 2016 at 11:22pm", "created_by": "ChrisMackey", "replies": []}, {"body": "", "attachments": [], "created_by_name": "Chris Mackey", "created_at": "August 19, 2016 at 9:05pm", "created_by": "ChrisMackey", "replies": []}, {"body": "\nYep -- will upload it tomorrow.\u00a0\n", "attachments": [], "created_by_name": "Julia S", "created_at": "August 21, 2016 at 9:24am", "created_by": "JuliaS", "replies": []}, {"body": "\nSee file attached -- let me know if there's anything to be done.\n\n\n\nOn that note, does the Export to OpenStudio component do anything different from\u00a0 launching OpenStudio and doing File/Import/IDF file? (I know that just importing an IDF into OpenStudio doesn't import everything from the IDF file.) If you connect an HVAC system, does this export automatically create the system in the IDF or do you still have to do it in OS after? Thanks!\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1585360", "name": "JS_ExportToOSExample.gh"}], "created_by_name": "Julia S", "created_at": "August 22, 2016 at 7:05am", "created_by": "JuliaS", "replies": []}, {"body": "\nJulia,\n\nThank you for posting this. It seems the issue was as I feared. \u00a0All of the components in your Grasshopper file are up to date and your GH file is running fine for me. \u00a0So it is a bug affecting your system type just as the previous bug.\n\nWould you mind opening the attached version of your file and let me know what the text in the panel is?\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/DmYnIaXFmPqFSEHVsQcDVIrGPiFQwywWOG4erAFlGq4ljZBFo-YYpMTd5crkDshy7mumo*LwlAeb-4-8ixv-jxQN5qkr2sNF/PostThisText.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/DmYnIaXFmPqFSEHVsQcDVIrGPiFQwywWOG4erAFlGq4ljZBFo-YYpMTd5crkDshy7mumo*LwlAeb-4-8ixv-jxQN5qkr2sNF/PostThisText.JPG)\n\nThis will help me understand what version of OpenStudio the component is finding on your system. \u00a0Perhaps there's still a chance that it found an old version of OpenStudio somewhere.\n\n-Chris\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1586248", "name": "JS_ExportToOSExample_CWM.gh"}], "created_by_name": "Chris Mackey", "created_at": "August 22, 2016 at 5:41pm", "created_by": "ChrisMackey", "replies": []}, {"body": "\nAlso, Julia, I forgot to answer your question. \u00a0The Export to OpenStudio component is not not doing any heavy-lifting in writing an IDF. \u00a0Rather, it is writing an .osm file for OpenStudio using OpenStudio's API (this makes it MUCH easier to add detailed HVAC Systems to the model). \u00a0The component then uses the OpenStudio API to covert the .osm to an .idf that can be run through EnergyPlus. \u00a0This is a very different way of working than using the \"Import IDF\" functionality that you mentioned as this would probably reult in a lot of information loss, as you say.\n\n-Chris\n", "attachments": [], "created_by_name": "Chris Mackey", "created_at": "August 23, 2016 at 7:03am", "created_by": "ChrisMackey", "replies": []}, {"body": "\nHey, this is what I'm getting:\n\n\n\nOpenStudio Library path set to C:/Program Files/OpenStudio 1.12.0/CSharp/openstudio/<br/>Current working directory is set to:\u00a0 c:\\ladybug\\test_1zone_ex\\OpenStudio<br/>Runtime error (TypeInitializationException): The type initializer for 'OpenStudio.OpenStudioModelCorePINVOKE' threw an exception.<br/>Traceback:<br/>\u00a0 line 3528, in main, \"&lt;string&gt;\"<br/>\u00a0 line 3747, in script\n\n\n\nAnd thanks for clarifying what the component does. If there's no solution\u00a0to fixing\u00a0this on my system, I guess I'll just learn to create my HVAC systems myself :). It's just annoying because I have to model one that doesn't come\u00a0as an\u00a0HVACTemplate object so it requires all the detailed inputs.\n\n\n", "attachments": [], "created_by_name": "Julia S", "created_at": "August 23, 2016 at 10:45am", "created_by": "JuliaS", "replies": []}, {"body": "\nJulia,\n\nThanks for responding quickly. \u00a0This confirms that it is indeed the same exact bug as before but with the newer version of OpenStudio. \u00a0I have reopened the github issue that you cited at the top of this post:\n\n[https://github.com/mostaphaRoudsari/Honeybee/issues/214](https://github.com/mostaphaRoudsari/Honeybee/issues/214)\n\nWe are going to need OpenStudio team's help to fix this and you can watch that github thread to see what they have to say. \u00a0Let's hope that it is not too long before we can get it fixed.\n\n-Chris\n", "attachments": [], "created_by_name": "Chris Mackey", "created_at": "August 23, 2016 at 12:17pm", "created_by": "ChrisMackey", "replies": []}, {"body": "\nOK, thank you! Hopefully something will get resolved!\n", "attachments": [], "created_by_name": "Julia S", "created_at": "August 24, 2016 at 7:11am", "created_by": "JuliaS", "replies": []}]}], "id": "1583969"}