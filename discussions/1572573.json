{"body": "\nHi there!\n\nWe are working on a university project about lighting design and daylighting evaluation for an office building located in Trento (Italy).\n\nWe are currently performing a daylight analysis and calculating the daylight factor and everything works when we consider only the geometry of the building itself.\n\nOne of the tasks that we want to furhter implement is the insertion of the surrounding environment (the office is located near a mountain area).\n\nWe modeled the mountain using the geo-location function of Sketchup, imported the geometry into Rhino and created the surface.\n\nThen we added the mountain to grasshopper throug a brep, but then it is no longer able to run the simulation.\n\nIsn't Grasshopper able to handle such complex surfaces? Or are we doing something wrong?\n\nYou can find the gh file we used attached to this message.\n\nThank you in advance!\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1572572", "name": "prj_prova.gh"}], "created_by_name": "Giacomo Luddeni", "created_at": "July 28, 2016 at 6:13am", "created_by": "GiacomoLuddeni", "topic": "daylight simulation using complex surfaces", "replies": [{"body": "\nCan't check your file right now, but i suggest trying the recent Djordje's addition: terrainShadingMask.\n\nSearch for it in the group. I'm sure you'll find it useful.\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "July 28, 2016 at 7:57am", "created_by": "AbrahamYezioro", "replies": [{"body": "\nThanks! I try it\n", "attachments": [], "created_by_name": "Giacomo Luddeni", "created_at": "July 28, 2016 at 8:20am", "created_by": "GiacomoLuddeni", "replies": []}]}, {"body": "\nUpdate: the terrain Shading Mask component was very helpful and I managed to create it.\n\nHow can I then couple the shading mask with the sky component to let it influence the illuminance analysis?\n\nThanks\n", "attachments": [], "created_by_name": "Giacomo Luddeni", "created_at": "July 28, 2016 at 1:15pm", "created_by": "GiacomoLuddeni", "replies": [{"body": "\nStill, without seeing the file, i was thinking about the terrainShadingMask to be used as context. In this way it will block the direct sun. If you are interested in the indirect/diffuse i recommend to build basic surface that represent the site conditions.\n\nMakes sense?\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "July 28, 2016 at 8:08pm", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nAbraham,\n\nthanks for your answers.\n\nIt would be enough for me to use the mask to block the direct radiation. I already tried to connect it to the geometry (image below) but it does not work. Is there something missing?<br/><br/>[<img class=\"align-full\" src=\"http://api.ning.com:80/files/WDvxeYqj4vpYM5V*hqFE6CTFNE3qrdd-J87YFnvGqo0Oow7T2CWzOY8uLToztQYut91Gef9YSPsSrTqYOf3sPFyYsUSdWQv1/mask.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/WDvxeYqj4vpYM5V*hqFE6CTFNE3qrdd-J87YFnvGqo0Oow7T2CWzOY8uLToztQYut91Gef9YSPsSrTqYOf3sPFyYsUSdWQv1/mask.JPG)\n", "attachments": [], "created_by_name": "Giacomo Luddeni", "created_at": "July 29, 2016 at 2:31am", "created_by": "GiacomoLuddeni", "replies": []}, {"body": "\nI suppose you need to pass the geometries through the HB_Surface component to make them recognizable by HB (I mean ALL your geometries: ground, terrain and of course the room).\n\nFrom your image i'm not sure you are doing that.\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "July 29, 2016 at 6:19am", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nOk, there was one HBsurface missing. Now the simulation runs.<br/>However the illuminance analysis shows exactly the same results, with or without the shading mask, even when the sun is very low.\n\nMaybe the mask is placed too far from my geometry to show noticeable results.<br/>I'm wondering how does it decide where to place the mask (given that I put no input data as context_ in the TerrainShadingMask element).\n\nIs it actually placed in such a way to give the same shading effect as the real terrain geometry?\n\nThanks for the answers!\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/-UOsCXDQFwGR5-3Vic3r5YbncZgEfnz75dHHrkfg*-hPodE4AQxMWvfPTvG*jibloGUlvMUbFydEfOXym7uCzVy8XynPHK*y/Cattura.JPG?width=721\" width=\"721\"/>](http://api.ning.com:80/files/-UOsCXDQFwGR5-3Vic3r5YbncZgEfnz75dHHrkfg*-hPodE4AQxMWvfPTvG*jibloGUlvMUbFydEfOXym7uCzVy8XynPHK*y/Cattura.JPG)\n", "attachments": [], "created_by_name": "Giacomo Luddeni", "created_at": "July 30, 2016 at 9:20am", "created_by": "GiacomoLuddeni", "replies": []}, {"body": "\nAbout the location (radius of the mask) see my questions and Djordje's answers in the discussion about this component. If you don't give any context you'll get the same radius as the default sunpath component.\n\nAt this point, looking at the mask's image, see the hours where the mask blocks the sun. Seems that the influence of the topography happens at late hours.\n\nPost the updated file where the geometry is internalised (specially the mask's) so people here can have a better look.\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "July 30, 2016 at 10:58am", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nHere is the file.\n\nThere is still a problem while connecting the mask with the other geometries.\n\nThanks.\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1573728", "name": "prj_prova_internalized.gh"}], "created_by_name": "Giacomo Luddeni", "created_at": "July 30, 2016 at 12:32pm", "created_by": "GiacomoLuddeni", "replies": []}, {"body": "\nI don't know what is the problem you mentioned. It runs fine in my system.<br/> Anyway, i added a sunpath (independent) and set the hour where i see the sun is blocked by the mask.<br/>\nI tested with and without the topography and i can't say the results are substantially different. Though there are differences (small ones). So the mask is affecting the simulation results. It happens that it is low or it is far away from your site.<br/>\n-A.\n", "attachments": [{"link": "http://www.grasshopper3d.com/group/ladybug/forum/attachment/download?id=2985220%3AUploadedFile%3A1573836", "name": "prj_prova_internalized_AY.gh"}], "created_by_name": "Abraham Yezioro", "created_at": "July 30, 2016 at 7:04pm", "created_by": "AbrahamYezioro", "replies": []}, {"body": "\nThe fact is that I expected the influence of the mask to be greater.<br/>I run the analysis with a finer grid when the sun should be covered by the mask. The results with and without the mask are below (the only noticeable difference is the Daylight Factor).\n\n<br/>Actually I tried also to create the mask of the mountain using the topography I imported from Sketchup and the Ladybug Shading Mask II component. In this way the shading effect is well noticeable, but the process of creating the mask from such a complex geometry is very slow.\n\nI was just curios to see this terrain shading mask working because, for future projects, it would be easier and faster to use.\n\nThanks!\n\n[<img class=\"align-full\" src=\"http://api.ning.com:80/files/KMK8bRYqKW2eaoPypMydIjkAiQsp9tVHAswOMvJODNFymA-UQwP1BVsAJBrjs41kz80Tz19oXyMToRcgJQ8semoR0sBBOfY3/sun_position.JPG?width=250\" width=\"250\"/>](http://api.ning.com:80/files/KMK8bRYqKW2eaoPypMydIjkAiQsp9tVHAswOMvJODNFymA-UQwP1BVsAJBrjs41kz80Tz19oXyMToRcgJQ8semoR0sBBOfY3/sun_position.JPG)[<img class=\"align-full\" src=\"http://api.ning.com:80/files/KMK8bRYqKW07ZZTyjzulD8F7MuHMbHXqmVQAh4-eg7slVIjS3KizPo4zqVkC6ETjtazjVJnQk*BiqFa3HjSUWpaoC8HH3iA8/with_terrain.JPG?width=350\" width=\"350\"/>](http://api.ning.com:80/files/KMK8bRYqKW07ZZTyjzulD8F7MuHMbHXqmVQAh4-eg7slVIjS3KizPo4zqVkC6ETjtazjVJnQk*BiqFa3HjSUWpaoC8HH3iA8/with_terrain.JPG)[<img class=\"align-full\" src=\"http://api.ning.com:80/files/KMK8bRYqKW3P70esNuIbMhczmzB4nTKZgbPwDwdIyeYQ5oF2fg*PoWa9jGjQwJZzOplP8nMFnn8rhBSDwwOFNn*9UDMBdZJK/without_mask.JPG?width=350\" width=\"350\"/>](http://api.ning.com:80/files/KMK8bRYqKW3P70esNuIbMhczmzB4nTKZgbPwDwdIyeYQ5oF2fg*PoWa9jGjQwJZzOplP8nMFnn8rhBSDwwOFNn*9UDMBdZJK/without_mask.JPG)\n", "attachments": [], "created_by_name": "Giacomo Luddeni", "created_at": "July 31, 2016 at 3:31am", "created_by": "GiacomoLuddeni", "replies": []}, {"body": "\nTheoretically the maskTopography and the ShadingmaskII should be similar (the mask) and as such their influence.\n\nI'm not sure if your case is influenced by the geometry of the room and it's orientation and window locations, rather than the mask itself.\n\nI would try a basic case (one room, one window) that you can check parametrically (orientation, window size, etc) in order to understand better the mask influence.\n\n-A.\n", "attachments": [], "created_by_name": "Abraham Yezioro", "created_at": "July 31, 2016 at 7:27am", "created_by": "AbrahamYezioro", "replies": []}]}], "id": "1572573"}